import * as XML from './xml';
import * as DATE from './date';

export function xmlMovAD(campos: any, CODCOLIGADA: string, CODFILIAL: string, SERIE: string, CODTMV: string, ESTOQUE: string, HISTORICOCURTO: string) : string {
    try {
        // let listaDeItens = campos.itens as object[];
    
        var cData = '';
        cData += '<![CDATA['
            cData += '<MovMovimento>'
                cData += '<TMOV>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODFILIAL', CODFILIAL)
                    cData += XML.montaTag('CODLOC', ESTOQUE)
                    cData += XML.montaTag('CODLOCDESTINO', ESTOQUE)
                    cData += XML.montaTag('CODCFO', campos.codigoDoFornecedor)
                    cData += XML.montaTag('NUMEROMOV', '-1')
                    cData += XML.montaTag('SERIE', 'AD')
                    cData += XML.montaTag('CODTMV', CODTMV)
                    cData += XML.montaTag('TIPO', 'A')
                    cData += XML.montaTag('MOVIMPRESSO', '0')
                    cData += XML.montaTag('DOCIMPRESSO', '0')
                    cData += XML.montaTag('FATIMPRESSA', '0')
                    cData += XML.montaTag('DATAEMISSAO', DATE.getDateTime())
                    cData += XML.montaTag('COMISSAOREPRES', '0.0000')
                    cData += XML.montaTag('CODCPG', campos.codigoDaFormaPagamento)
                    cData += XML.montaTag('VALORBRUTO', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDO', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROS', campos.valorTotal)
                    cData += XML.montaTag('PERCENTUALFRETE', '0.0000')
                    cData += XML.montaTag('VALORFRETE', '0.0000')
                    cData += XML.montaTag('PERCENTUALDESC', '0.0000')
                    cData += XML.montaTag('VALORDESC', '0.0000')
                    cData += XML.montaTag('PERCENTUALDESP', '0.0000')
                    cData += XML.montaTag('VALORDESP', '0.0000')
                    cData += XML.montaTag('PERCCOMISSAO', '0.0000')
                    cData += XML.montaTag('CODMEN', '01')
                    cData += XML.montaTag('PESOLIQUIDO', '0.0000')
                    cData += XML.montaTag('PESOBRUTO', '0.0000')
                    cData += XML.montaTag('IDMOVLCTFLUXUS', '-1')
                    cData += XML.montaTag('CODMOEVALORLIQUIDO', 'R$')
                    cData += XML.montaTag('DATAMOVIMENTO', DATE.getDateTime())
                    cData += XML.montaTag('GEROUFATURA', '0')
                    cData += XML.montaTag('NUMEROLCTABERTO', '1')
                    cData += XML.montaTag('CODCFOAUX', campos.codigoDoFornecedor)
                    cData += XML.montaTag('VALORRECEBIDO', campos.valorTotal)
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('CODVEN1', campos.codigoDoComprador)
                    cData += XML.montaTag('PERCCOMISSAOVEN2', '0.0000')
                    cData += XML.montaTag('CODCOLCFO', '0')
                    cData += XML.montaTag('CODUSUARIO', 'p_heflo')
                    cData += XML.montaTag('CODFILIALDESTINO', CODFILIAL)
                    cData += XML.montaTag('GERADOPORLOTE', '0')
                    cData += XML.montaTag('STATUSEXPORTCONT', '0')
                    cData += XML.montaTag('GEROUCONTATRABALHO', '0')
                    cData += XML.montaTag('GERADOPORCONTATRABALHO', '0')
                    cData += XML.montaTag('HORULTIMAALTERACAO', DATE.getDateTime())
                    cData += XML.montaTag('INDUSOOBJ', '0.00')
                    cData += XML.montaTag('INTEGRADOBONUM', '0')
                    cData += XML.montaTag('FLAGPROCESSADO', '0')
                    cData += XML.montaTag('ABATIMENTOICMS', '0.0000')
                    cData += XML.montaTag('HORARIOEMISSAO', DATE.getDateTime())
                    cData += XML.montaTag('USUARIOCRIACAO', 'p_heflo')
                    cData += XML.montaTag('STSEMAIL', '0.0000')
                    cData += XML.montaTag('VALORBRUTOINTERNO', campos.valorTotal)
                    cData += XML.montaTag('VINCULADOESTOQUEFL', '0.0000')
                    cData += XML.montaTag('VRBASEINSSOUTRAEMPRESA', '0.0000')
                    cData += XML.montaTag('VALORDESCCONDICIONAL', '0.0000')
                    cData += XML.montaTag('VALORDESPCONDICIONAL', '0.0000')
                    cData += XML.montaTag('INTEGRADOAUTOMACAO', '0.0000')
                    cData += XML.montaTag('INTEGRAAPLICACAO', 'T')
                    cData += XML.montaTag('DATALANCAMENTO', DATE.getDateTime())
                    cData += XML.montaTag('RECIBONFESTATUS', '0')
                    cData += XML.montaTag('VALORMERCADORIAS', '0.0000')
                    cData += XML.montaTag('USARATEIOVALORFIN', '1')
                    cData += XML.montaTag('CODCOLCFOAUX', '0')
                    cData += XML.montaTag('VALORRATEIOLAN', campos.valorTotal)
                    cData += XML.montaTag('RATEIOCCUSTODEPTO', campos.valorTotal)
                    cData += XML.montaTag('VALORBRUTOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROSORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORRATEIOLANORIG', campos.valorTotal)
                    cData += XML.montaTag('HISTORICOCURTO', HISTORICOCURTO)
                    cData += XML.montaTag('FLAGCONCLUSAO', '0')
                    cData += XML.montaTag('STATUSPARADIGMA', 'N')
                    cData += XML.montaTag('STATUSINTEGRACAO', 'N')
                    cData += XML.montaTag('PERCCOMISSAOVEN3', '0.0000')
                    cData += XML.montaTag('PERCCOMISSAOVEN4', '0.0000')
                    cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA)
                    cData += XML.montaTag('IDMOVHST', '-1')
                cData += '</TMOV>'
                cData += '<TNFE>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('VALORSERVICO', '0.0000')
                    cData += XML.montaTag('DEDUCAOSERVICO', '0.0000')
                    cData += XML.montaTag('ALIQUOTAISS', '0.0000')
                    cData += XML.montaTag('ISSRETIDO', '0')
                    cData += XML.montaTag('VALORISS', '0.0000')
                    cData += XML.montaTag('VALORCREDITOIPTU', '0.0000')
                    cData += XML.montaTag('BASEDECALCULO', '0.0000')
                    cData += XML.montaTag('EDITADO', '0')
                cData += '</TNFE>'
                cData += '<TMOVFISCAL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CONTRIBUINTECREDENCIADO', '0')
                    cData += XML.montaTag('OPERACAOCONSUMIDORFINAL', '0')
                    cData += XML.montaTag('OPERACAOPRESENCIAL', '0')
                cData += '</TMOVFISCAL>'
                cData += '<TMOVRATCCU>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('VALOR', campos.valorTotal)
                    cData += XML.montaTag('IDMOVRATCCU', '-1')
                cData += '</TMOVRATCCU>'
                cData += '<TMOVPAGTO>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDSEQPAGTO', '-1');
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('TAXAADM', '0.0000');
                    cData += XML.montaTag('IDLAN', '-1');
                    cData += XML.montaTag('DATAVENCIMENTO', DATE.getDateTime());
                    cData += XML.montaTag('TIPOPAGAMENTO', '1');
                    cData += XML.montaTag('VALOR', campos.valorTotal);
                    cData += XML.montaTag('DEBITOCREDITO', 'C');
                    cData += XML.montaTag('IDSEQPAGTO1', '-1');
                cData += '</TMOVPAGTO>'
                cData += '<TITMMOV>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('NSEQITMMOV', '1');
                    cData += XML.montaTag('CODFILIAL', CODFILIAL);
                    cData += XML.montaTag('NUMEROSEQUENCIAL', '1');
                    cData += XML.montaTag('IDPRD', '8');
                    cData += XML.montaTag('QUANTIDADE', '1');
                    cData += XML.montaTag('PRECOUNITARIO', campos.valorTotal); // PRECO UNITARIO
                    cData += XML.montaTag('PRECOTABELA', '0.0000');
                    cData += XML.montaTag('DATAEMISSAO', DATE.getDateTime());
                    cData += XML.montaTag('CODUND', 'UN');
                    cData += XML.montaTag('QUANTIDADEARECEBER', '1');
                    cData += XML.montaTag('VALORUNITARIO', '0.0000');
                    cData += XML.montaTag('VALORFINANCEIRO', '0.0000');
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                    cData += XML.montaTag('ALIQORDENACAO', '0.0000');
                    cData += XML.montaTag('QUANTIDADEORIGINAL', '1');
                    cData += XML.montaTag('FLAG', '0');
                    cData += XML.montaTag('FATORCONVUND', '0.0000');
                    cData += XML.montaTag('VALORBRUTOITEM', '0.0000'); 
                    cData += XML.montaTag('ITEM', campos.valorTotal);// PRECO UNITARIO X QTD
                    cData += XML.montaTag('QUANTIDADESEPARADA', campos.valorTotal); // PRECO UNITARIO X QTD
                    cData += XML.montaTag('COMISSAOREPRES', '0.0000');
                    cData += XML.montaTag('VALORESCRITURACAO', '0.0000');
                    cData += XML.montaTag('VALORFINPEDIDO', '0.0000');
                    cData += XML.montaTag('VALOROPFRM1', '0.0000');
                    cData += XML.montaTag('VALOROPFRM2', '0.0000');
                    cData += XML.montaTag('PRECOEDITADO', '0');
                    cData += XML.montaTag('QTDEVOLUMEUNITARIO', '1');
                    cData += XML.montaTag('CODVEN1', campos.codigoDoComprador);
                    cData += XML.montaTag('PRECOTOTALEDITADO', '0');
                    cData += XML.montaTag('VALORDESCCONDICONALITM', '0.0000');
                    cData += XML.montaTag('VALORDESPCONDICIONALITM', '0.0000');
                    cData += XML.montaTag('CODTBORCAMENTO', '02.23.00001');
                    cData += XML.montaTag('CODCOLTBORCAMENTO', '0');
                    cData += XML.montaTag('VALORUNTORCAMENTO', '0.0000');
                    cData += XML.montaTag('VALSERVICONFE', '0.0000');
                    cData += XML.montaTag('CODLOC', ESTOQUE);
                    cData += XML.montaTag('VALORBEM', '0.0000');
                    cData += XML.montaTag('VALORLIQUIDO', campos.valorTotal); // PRECO UNITARIO X QTD
                    cData += XML.montaTag('RATEIOCCUSTODEPTO', campos.valorTotal); // PRECO UNITARIO X QTD
                    cData += XML.montaTag('VALORBRUTOITEMORIG', campos.valorTotal); // PRECO UNITARIO X QTD
                    cData += XML.montaTag('QUANTIDADETOTAL', '0.0000');
                    cData += XML.montaTag('PRODUTOSUBSTITUTO', '0');
                    cData += XML.montaTag('PRECOUNITARIOSELEC', '0');
                    cData += XML.montaTag('QUANTIDADECONCLUIDA', '1');
                    cData += XML.montaTag('INTEGRAAPLICACAO', "T");
                    cData += XML.montaTag('VALORBASEDEPRECIACAOBEM', '0');
                    cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA);
                    cData += XML.montaTag('IDMOVHST', '-1');
                    cData += XML.montaTag('NSEQITMMOV1', '1');
                cData += '</TITMMOV>'
                cData += '<TITMMOVRATCCU>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('NSEQITMMOV', '1');
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                    cData += XML.montaTag('VALOR', campos.valorTotal); // PRECO UNITARIO X QTD
                    cData += XML.montaTag('IDMOVRATCCU', '-1');
                cData += '</TITMMOVRATCCU>'
                // cData += '<TMOVPAGTO>'
                //     cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                //     cData += XML.montaTag('IDSEQPAGTO', '-1');
                //     cData += XML.montaTag('IDMOV', '-1');
                //     cData += XML.montaTag('CODCOLCFODEFAULT', '0');
                //     cData += XML.montaTag('TIPOFORMAPAGTO', '3');
                //     cData += XML.montaTag('TAXAADM', '0.0000');
                //     cData += XML.montaTag('CODCXA', '003');
                //     cData += XML.montaTag('CODCOLCXA', '0');
                //     cData += XML.montaTag('IDLAN', '-1');
                //     cData += XML.montaTag('IDFORMAPAGTO', '2');
                //     cData += XML.montaTag('DATAVENCIMENTO', DATE.getDateTime());
                //     cData += XML.montaTag('TIPOPAGAMENTO', '1');
                //     cData += XML.montaTag('VALOR', campos.valorTotal);
                //     cData += XML.montaTag('DEBITOCREDITO', 'C');
                //     cData += XML.montaTag('IDSEQPAGTO1', '-1');
                //  cData += '</TMOVPAGTO>'
                cData += '<TITMMOVCOMPL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('NSEQITMMOV', '1');
                cData += '</TITMMOVCOMPL>'
                // if(OC !== '' || AD !== ''){
                //     cData += '<TITMMOVRELAC>'
                //         cData += XML.montaTag('IDMOVORIGEM', OC);
                //         cData += XML.montaTag('NSEQITMMOVORIGEM', (i + 1).toString());
                //         cData += XML.montaTag('CODCOLORIGEM', CODCOLIGADA);
                //         cData += XML.montaTag('IDMOVDESTINO', '-1');
                //         cData += XML.montaTag('NSEQITMMOVDESTINO', (i + 1).toString());
                //         cData += XML.montaTag('CODCOLDESTINO', CODCOLIGADA);
                //         cData += XML.montaTag('QUANTIDADE', '1');
                //     cData += '</TITMMOVRELAC>'
                // }
                // for (let j = 0; j < tributos.length; j++) {
                //     cData += '<TTRBITMMOV>';
                //         cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA); 
                //         cData += XML.montaTag('IDMOV', '-1');  
                //         cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());   
                //         cData += XML.montaTag('CODTRB', tributos[j]);
                //         cData += XML.montaTag('BASEDECALCULO', totalDoItem);
                //         cData += XML.montaTag('VALOR', '0.0000');    
                //         cData += XML.montaTag('FATORREDUCAO', '0.0000');
                //         cData += XML.montaTag('FATORSUBSTTRIB', '0.0000');
                //         cData += XML.montaTag('BASEDECALCULOCALCULADA', totalDoItem);
                //         cData += XML.montaTag('EDITADO', '0');
                //         cData += XML.montaTag('PERCDIFERIMENTOPARCIALICMS', '0.0000');
                //         cData += XML.montaTag('BASECHEIA', '0.0000');
                //     cData += '</TTRBITMMOV>';
                // }
                cData += '<TITMMOVFISCAL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('NSEQITMMOV', '1');
                    cData += XML.montaTag('QTDECONTRATADA', '0.0000');
                    cData += XML.montaTag('VLRTOTTRIB', '0.0000');
                    cData += XML.montaTag('AQUISICAOPAA', '0');
                    cData += XML.montaTag('POEBTRIBUTAVEL', '1');
                cData += '</TITMMOVFISCAL>';
                cData += '<TMOVCOMPL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('MULTIPLO', 'N');
                    cData += XML.montaTag('TICKET', campos.ticketRaiz);
                    cData += XML.montaTag('LINKDOCUMENTO', (campos.anexarNotaFiscal).slice(0, 255));
                    cData += XML.montaTag('REMETENTE', campos.remetente);
                    cData += XML.montaTag('INICIOPRESTACAO', campos.inicioDaPrestacao);
                    cData += XML.montaTag('DESTINATARIO', campos.destinatario);
                    cData += XML.montaTag('TERMINOPRESTACAO', campos.terminoDaPrestacao);
                cData += '</TMOVCOMPL>'
                cData += '<TMOVTRANSP>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('RETIRAMERCADORIA', '0')
                    cData += XML.montaTag('TIPOCTE', '0')
                    cData += XML.montaTag('TOMADORTIPO', '0')
                    cData += XML.montaTag('TIPOEMITENTEMDFE', '0')
                    cData += XML.montaTag('LOTACAO', '1')
                    cData += XML.montaTag('TIPOTRANSPORTADORMDFE', '0')
                    cData += XML.montaTag('TIPOBPE', '0')
                cData += '</TMOVTRANSP>'
            cData += '</MovMovimento>'
        cData += ']]>';

        return cData;

    } catch (error) {
        console.log(error);
        throw error; 
    }

}

export function xmlMovNM(campos: any, CODCOLIGADA: string, CODFILIAL: string, SERIE: string, CODTMV: string, ESTOQUE: string, HISTORICOCURTO: string) {
    try {
        let listaDeItens = campos.itens as object[];
        let listaDeParcelas = campos.parcelas as object[];
    
        var cData = '';
        cData += '<![CDATA['
            cData += '<MovMovimento>'
                cData += '<TMOV>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODFILIAL', CODFILIAL)
                    cData += XML.montaTag('CODLOC', ESTOQUE)
                    cData += XML.montaTag('CODLOCDESTINO', ESTOQUE)
                    cData += XML.montaTag('CODCFO', campos.codigoDoFornecedor)
                    cData += XML.montaTag('NUMEROMOV', (campos.numeroDaNF).slice(0, 9))
                    cData += XML.montaTag('SERIE', SERIE)
                    cData += XML.montaTag('CODTMV', CODTMV)
                    cData += XML.montaTag('TIPO', 'A')
                    cData += XML.montaTag('MOVIMPRESSO', '0')
                    cData += XML.montaTag('DOCIMPRESSO', '0')
                    cData += XML.montaTag('FATIMPRESSA', '0')
                    cData += XML.montaTag('DATAEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('COMISSAOREPRES', '0.0000')
                    cData += XML.montaTag('CHAVEACESSONFE', campos.chaveDeAcesso)
                    cData += XML.montaTag('CODCPG', campos.codigoDaFormaPagamento)
                    cData += XML.montaTag('VALORBRUTO', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDO', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROS', campos.valorTotal)
                    cData += XML.montaTag('FRETECIFOUFOB', campos.tipoDeFrete)
                    cData += XML.montaTag('PERCENTUALFRETE', '0.0000')
                    cData += XML.montaTag('VALORFRETE', campos.valorDoFrete)
                    cData += XML.montaTag('PERCENTUALDESC', '0.0000')
                    cData += XML.montaTag('VALORDESC', '0.0000')
                    cData += XML.montaTag('PERCENTUALDESP', '0.0000')
                    cData += XML.montaTag('VALORDESP', campos.outrasDespesas)
                    cData += XML.montaTag('PERCCOMISSAO', '0.0000')
                    cData += XML.montaTag('CODMEN', '01')
                    cData += XML.montaTag('PESOLIQUIDO', '0.0000')
                    cData += XML.montaTag('PESOBRUTO', '0.0000')
                    cData += XML.montaTag('IDMOVLCTFLUXUS', '-1')
                    cData += XML.montaTag('CODMOEVALORLIQUIDO', 'R$')
                    cData += XML.montaTag('DATAMOVIMENTO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('GEROUFATURA', '0')
                    cData += XML.montaTag('NUMEROLCTABERTO', '1')
                    cData += XML.montaTag('CODCFOAUX', campos.codigoDoFornecedor)
                    cData += XML.montaTag('VALORRECEBIDO', campos.valorTotal)
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('CODVEN1', campos.codigoDoComprador)
                    cData += XML.montaTag('VALOREXTRA1', campos.maoDeObra);
                    cData += XML.montaTag('VALOREXTRA2', '0.0000');
                    cData += XML.montaTag('PERCCOMISSAOVEN2', '0.0000')
                    cData += XML.montaTag('CODCOLCFO', '0')
                    cData += XML.montaTag('CODUSUARIO', 'p_heflo')
                    cData += XML.montaTag('CODFILIALDESTINO', CODFILIAL)
                    cData += XML.montaTag('GERADOPORLOTE', '0')
                    cData += XML.montaTag('STATUSEXPORTCONT', '0')
                    cData += XML.montaTag('GEROUCONTATRABALHO', '0')
                    cData += XML.montaTag('GERADOPORCONTATRABALHO', '0')
                    cData += XML.montaTag('HORULTIMAALTERACAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('INDUSOOBJ', '0.00')
                    cData += XML.montaTag('INTEGRADOBONUM', '0')
                    cData += XML.montaTag('FLAGPROCESSADO', '0')
                    cData += XML.montaTag('ABATIMENTOICMS', '0.0000')
                    cData += XML.montaTag('HORARIOEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('USUARIOCRIACAO', 'p_heflo')
                    cData += XML.montaTag('STSEMAIL', '0.0000')
                    cData += XML.montaTag('VALORBRUTOINTERNO', campos.valorTotal)
                    cData += XML.montaTag('VINCULADOESTOQUEFL', '0.0000')
                    cData += XML.montaTag('VRBASEINSSOUTRAEMPRESA', '0.0000')
                    cData += XML.montaTag('VALORDESCCONDICIONAL', '0.0000')
                    cData += XML.montaTag('VALORDESPCONDICIONAL', '0.0000')
                    cData += XML.montaTag('INTEGRADOAUTOMACAO', '0.0000')
                    cData += XML.montaTag('INTEGRAAPLICACAO', 'T')
                    cData += XML.montaTag('DATALANCAMENTO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('RECIBONFESTATUS', '0')
                    cData += XML.montaTag('VALORMERCADORIAS', '0.0000')
                    cData += XML.montaTag('USARATEIOVALORFIN', '1')
                    cData += XML.montaTag('CODCOLCFOAUX', '0')
                    cData += XML.montaTag('VALORRATEIOLAN', campos.valorTotal)
                    cData += XML.montaTag('RATEIOCCUSTODEPTO', campos.valorTotal)
                    cData += XML.montaTag('VALORBRUTOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROSORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORRATEIOLANORIG', campos.valorTotal)
                    cData += XML.montaTag('HISTORICOCURTO', HISTORICOCURTO)
                    cData += XML.montaTag('FLAGCONCLUSAO', '0')
                    cData += XML.montaTag('STATUSPARADIGMA', 'N')
                    cData += XML.montaTag('STATUSINTEGRACAO', 'N')
                    cData += XML.montaTag('PERCCOMISSAOVEN3', '0.0000')
                    cData += XML.montaTag('PERCCOMISSAOVEN4', '0.0000')
                    cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA)
                    cData += XML.montaTag('IDMOVHST', '-1')
                cData += '</TMOV>'
                cData += '<TNFE>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('VALORSERVICO', '0.0000')
                    cData += XML.montaTag('DEDUCAOSERVICO', '0.0000')
                    cData += XML.montaTag('ALIQUOTAISS', '0.0000')
                    cData += XML.montaTag('ISSRETIDO', '0')
                    cData += XML.montaTag('VALORISS', '0.0000')
                    cData += XML.montaTag('VALORCREDITOIPTU', '0.0000')
                    cData += XML.montaTag('BASEDECALCULO', '0.0000')
                    cData += XML.montaTag('EDITADO', '0')
                cData += '</TNFE>'
                cData += '<TMOVFISCAL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CONTRIBUINTECREDENCIADO', '0')
                    cData += XML.montaTag('OPERACAOCONSUMIDORFINAL', '0')
                    cData += XML.montaTag('OPERACAOPRESENCIAL', '0')
                cData += '</TMOVFISCAL>'
                cData += '<TMOVRATCCU>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('VALOR', campos.valorTotal)
                    cData += XML.montaTag('IDMOVRATCCU', '-1')
                cData += '</TMOVRATCCU>'
                for (let j = 0; j < listaDeParcelas.length; j++) {
                    let valorDaParcela = (listaDeParcelas[j] as { valorDaParcela: string }).valorDaParcela;
                    let vencimentoDaParcela = (listaDeParcelas[j] as { vencimentoDaParcela: string }).vencimentoDaParcela;

                    cData += '<TMOVPAGTO>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDSEQPAGTO', '-1');
                        cData += XML.montaTag('IDMOV', '-1');
                        //cData += XML.montaTag('TAXAADM', '0.0000');
                        cData += XML.montaTag('IDLAN', '-1');
                        cData += XML.montaTag('DATAVENCIMENTO', vencimentoDaParcela);
                        cData += XML.montaTag('TIPOPAGAMENTO', '1');
                        cData += XML.montaTag('VALOR', valorDaParcela);
                        //cData += XML.montaTag('DEBITOCREDITO', 'C');
                        cData += XML.montaTag('IDSEQPAGTO1', '-1');
                    cData += '</TMOVPAGTO>'
                }
                for (let i = 0; i < listaDeItens.length; i++) {
                    let codigoDaNatureza = (listaDeItens[i] as { codigoDaNatureza: string }).codigoDaNatureza;
                    let codigoDoItem = (listaDeItens[i] as { codigoDoItem: string }).codigoDoItem;
                    let qtdDoItem = (listaDeItens[i] as { qtdDoItem: string }).qtdDoItem;
                    let valorDoItem = (listaDeItens[i] as { valorDoItem: string }).valorDoItem;
                    let totalDoItem = (listaDeItens[i] as { totalDoItem: string }).totalDoItem;
            
                    cData += '<TITMMOV>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('CODFILIAL', CODFILIAL);
                        cData += XML.montaTag('NUMEROSEQUENCIAL', (i + 1).toString());
                        cData += XML.montaTag('IDPRD', codigoDoItem);
                        cData += XML.montaTag('QUANTIDADE', qtdDoItem);
                        cData += XML.montaTag('PRECOUNITARIO', valorDoItem); // PRECO UNITARIO
                        cData += XML.montaTag('PRECOTABELA', '0.0000');
                        cData += XML.montaTag('DATAEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao));
                        cData += XML.montaTag('CODUND', 'UN');
                        cData += XML.montaTag('QUANTIDADEARECEBER', qtdDoItem);
                        cData += XML.montaTag('VALORUNITARIO', '0.0000');
                        cData += XML.montaTag('VALORFINANCEIRO', '0.0000');
                        cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                        cData += XML.montaTag('ALIQORDENACAO', '0.0000');
                        cData += XML.montaTag('QUANTIDADEORIGINAL', qtdDoItem);
                        cData += XML.montaTag('FLAG', '0');
                        cData += XML.montaTag('FATORCONVUND', '0.0000');
                        cData += XML.montaTag('VALORBRUTOITEM', '0.0000'); 
                        cData += XML.montaTag('ITEM', totalDoItem);// PRECO UNITARIO X QTD
                        cData += XML.montaTag('QUANTIDADESEPARADA', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('COMISSAOREPRES', '0.0000');
                        cData += XML.montaTag('VALORESCRITURACAO', '0.0000');
                        cData += XML.montaTag('VALORFINPEDIDO', '0.0000');
                        cData += XML.montaTag('VALOROPFRM1', '0.0000');
                        cData += XML.montaTag('VALOROPFRM2', '0.0000');
                        cData += XML.montaTag('PRECOEDITADO', '0');
                        cData += XML.montaTag('QTDEVOLUMEUNITARIO', qtdDoItem);
                        cData += XML.montaTag('CODVEN1', campos.codigoDoComprador);
                        cData += XML.montaTag('PRECOTOTALEDITADO', '0');
                        cData += XML.montaTag('VALORDESCCONDICONALITM', '0.0000');
                        cData += XML.montaTag('VALORDESPCONDICIONALITM', '0.0000');
                        cData += XML.montaTag('CODTBORCAMENTO', codigoDaNatureza);
                        cData += XML.montaTag('CODCOLTBORCAMENTO', '0');
                        cData += XML.montaTag('VALORUNTORCAMENTO', '0.0000');
                        cData += XML.montaTag('VALSERVICONFE', '0.0000');
                        cData += XML.montaTag('CODLOC', ESTOQUE);
                        cData += XML.montaTag('VALORBEM', '0.0000');
                        cData += XML.montaTag('VALORLIQUIDO', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('RATEIOCCUSTODEPTO', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('VALORBRUTOITEMORIG', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('QUANTIDADETOTAL', '0.0000');
                        cData += XML.montaTag('PRODUTOSUBSTITUTO', '0');
                        cData += XML.montaTag('PRECOUNITARIOSELEC', '0');
                        cData += XML.montaTag('QUANTIDADECONCLUIDA', qtdDoItem);
                        cData += XML.montaTag('INTEGRAAPLICACAO', "T");
                        cData += XML.montaTag('VALORBASEDEPRECIACAOBEM', '0');
                        cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA);
                        cData += XML.montaTag('IDMOVHST', '-1');
                        cData += XML.montaTag('NSEQITMMOV1', (i + 1).toString());
                    cData += '</TITMMOV>'
                    cData += '<TITMMOVRATCCU>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                        cData += XML.montaTag('VALOR', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('IDMOVRATCCU', '-1');
                    cData += '</TITMMOVRATCCU>'
                    cData += '<TITMMOVCOMPL>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                    cData += '</TITMMOVCOMPL>'
                    // if(OC !== '' || AD !== ''){
                    //     cData += '<TITMMOVRELAC>'
                    //         cData += XML.montaTag('IDMOVORIGEM', OC);
                    //         cData += XML.montaTag('NSEQITMMOVORIGEM', (i + 1).toString());
                    //         cData += XML.montaTag('CODCOLORIGEM', CODCOLIGADA);
                    //         cData += XML.montaTag('IDMOVDESTINO', '-1');
                    //         cData += XML.montaTag('NSEQITMMOVDESTINO', (i + 1).toString());
                    //         cData += XML.montaTag('CODCOLDESTINO', CODCOLIGADA);
                    //         cData += XML.montaTag('QUANTIDADE', qtdDoItem);
                    //     cData += '</TITMMOVRELAC>'
                    // }
                    // for (let j = 0; j < tributos.length; j++) {
                    //     cData += '<TTRBITMMOV>';
                    //         cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA); 
                    //         cData += XML.montaTag('IDMOV', '-1');  
                    //         cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());   
                    //         cData += XML.montaTag('CODTRB', tributos[j]);
                    //         cData += XML.montaTag('BASEDECALCULO', totalDoItem);
                    //         cData += XML.montaTag('VALOR', '0.0000');    
                    //         cData += XML.montaTag('FATORREDUCAO', '0.0000');
                    //         cData += XML.montaTag('FATORSUBSTTRIB', '0.0000');
                    //         cData += XML.montaTag('BASEDECALCULOCALCULADA', totalDoItem);
                    //         cData += XML.montaTag('EDITADO', '0');
                    //         cData += XML.montaTag('PERCDIFERIMENTOPARCIALICMS', '0.0000');
                    //         cData += XML.montaTag('BASECHEIA', '0.0000');
                    //     cData += '</TTRBITMMOV>';
                    // }
                    cData += '<TITMMOVFISCAL>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('QTDECONTRATADA', '0.0000');
                        cData += XML.montaTag('VLRTOTTRIB', '0.0000');
                        cData += XML.montaTag('AQUISICAOPAA', '0');
                        cData += XML.montaTag('POEBTRIBUTAVEL', '1');
                    cData += '</TITMMOVFISCAL>';
                }
                cData += '<TMOVCOMPL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('MULTIPLO', 'N');
                    cData += XML.montaTag('TICKET', campos.ticketRaiz);
                    cData += XML.montaTag('LINKDOCUMENTO', (campos.anexarNotaFiscal).slice(0, 255));
                    cData += XML.montaTag('REMETENTE', campos.remetente);
                    cData += XML.montaTag('INICIOPRESTACAO', campos.inicioDaPrestacao);
                    cData += XML.montaTag('DESTINATARIO', campos.destinatario);
                    cData += XML.montaTag('TERMINOPRESTACAO', campos.terminoDaPrestacao);
                cData += '</TMOVCOMPL>'
                cData += '<TMOVTRANSP>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('RETIRAMERCADORIA', '0')
                    cData += XML.montaTag('TIPOCTE', '0')
                    cData += XML.montaTag('TOMADORTIPO', '0')
                    cData += XML.montaTag('TIPOEMITENTEMDFE', '0')
                    cData += XML.montaTag('LOTACAO', '1')
                    cData += XML.montaTag('TIPOTRANSPORTADORMDFE', '0')
                    cData += XML.montaTag('TIPOBPE', '0')
                cData += '</TMOVTRANSP>'
            cData += '</MovMovimento>'
        cData += ']]>';

        return cData;

    } catch (error) {
        console.log(error);
        throw error; 
    }

}

export function xmlMovNS(campos: any, CODCOLIGADA: string, CODFILIAL: string, SERIE: string, CODTMV: string, ESTOQUE: string, HISTORICOCURTO: string) {
    try {
        let listaDeItens = campos.itens as object[];
        let listaDeParcelas = campos.parcelas as object[];
        let listaDeTributos = campos.tributos as object[];

        let tributos = ''

        listaDeTributos.forEach((tributo, indice) => {
            tributos += '<TTRBITMMOV>';
                tributos += XML.montaTag('CODCOLIGADA', CODCOLIGADA); 
                tributos += XML.montaTag('IDMOV', '-1');  
                tributos += XML.montaTag('NSEQITMMOV', (indice + 1).toString());   
                tributos += XML.montaTag('CODTRB', (tributo as { codigoDoTributo: string }).codigoDoTributo);
                tributos += XML.montaTag('CODTRBBASE', (tributo as { codigoDoTributo: string }).codigoDoTributo);
                //tributos += XML.montaTag('ALIQUOTA', '0.0000');
                tributos += XML.montaTag('BASEDECALCULO', (tributo as { valorDaAliquota: string }).valorDaAliquota);
                //tributos += XML.montaTag('VALOR', '0.0000');    
                //tributos += XML.montaTag('FATORREDUCAO', '0.0000');
                //tributos += XML.montaTag('FATORSUBSTTRIB', '0.0000');
                tributos += XML.montaTag('BASEDECALCULOCALCULADA', (tributo as { valorDaAliquota: string }).valorDaAliquota);
                //tributos += XML.montaTag('EDITADO', '0');
                //tributos += XML.montaTag('PERCDIFERIMENTOPARCIALICMS', '0.0000');
                //tributos += XML.montaTag('BASECHEIA', '0.0000');
                tributos += XML.montaTag('CODRETENCAO',  (tributo as { codigoDeRetencao: string }).codigoDeRetencao);
            tributos += '</TTRBITMMOV>';
        });
    
        var cData = '';
        cData += '<![CDATA['
            cData += '<MovMovimento>'
                    cData += '<TMOV>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODFILIAL', CODFILIAL)
                    cData += XML.montaTag('CODLOC', ESTOQUE)
                    cData += XML.montaTag('CODLOCDESTINO', ESTOQUE)
                    cData += XML.montaTag('CODCFO', campos.codigoDoFornecedor)
                    cData += XML.montaTag('NUMEROMOV', (campos.numeroDaNF).slice(0, 9))
                    cData += XML.montaTag('SERIE', SERIE)
                    cData += XML.montaTag('CODTMV', CODTMV)
                    cData += XML.montaTag('TIPO', 'A')
                    cData += XML.montaTag('MOVIMPRESSO', '0')
                    cData += XML.montaTag('CODDADOSPGTO', '2')
                    cData += XML.montaTag('DOCIMPRESSO', '0')
                    cData += XML.montaTag('FATIMPRESSA', '0')
                    cData += XML.montaTag('DATAEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('COMISSAOREPRES', '0.0000')
                    cData += XML.montaTag('VALOREXTRA1', campos.maoDeObra);
                    cData += XML.montaTag('VALOREXTRA2', '0.0000');
                    cData += XML.montaTag('CODCPG', campos.codigoDaFormaPagamento)
                    cData += XML.montaTag('VALORBRUTO', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDO', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROS', campos.valorTotal)
                    cData += XML.montaTag('FRETECIFOUFOB', campos.tipoDeFrete)
                    cData += XML.montaTag('PERCENTUALFRETE', '0.0000')
                    cData += XML.montaTag('VALORFRETE', campos.valorDoFrete)
                    cData += XML.montaTag('PERCENTUALDESC', '0.0000')
                    cData += XML.montaTag('VALORDESC', '0.0000')
                    cData += XML.montaTag('PERCENTUALDESP', '0.0000')
                    cData += XML.montaTag('VALORDESP', campos.outrasDespesas)
                    cData += XML.montaTag('PERCCOMISSAO', '0.0000')
                    cData += XML.montaTag('CODMEN', '01')
                    cData += XML.montaTag('PESOLIQUIDO', '0.0000')
                    cData += XML.montaTag('IDNAT', '20')
                    cData += XML.montaTag('PESOBRUTO', '0.0000')
                    cData += XML.montaTag('IDMOVLCTFLUXUS', '-1')
                    cData += XML.montaTag('CODMOEVALORLIQUIDO', 'R$')
                    cData += XML.montaTag('DATAMOVIMENTO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('GEROUFATURA', '0')
                    cData += XML.montaTag('NUMEROLCTABERTO', '1')
                    cData += XML.montaTag('CODCFOAUX', campos.codigoDoFornecedor)
                    cData += XML.montaTag('VALORRECEBIDO', campos.valorTotal)
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('CODVEN1', campos.codigoDoComprador)
                    cData += XML.montaTag('PERCCOMISSAOVEN2', '0.0000')
                    cData += XML.montaTag('CODCOLCFO', '0')
                    cData += XML.montaTag('CODNAT', campos.naturezaFiscal)
                    cData += XML.montaTag('CODUSUARIO', 'p_heflo')
                    cData += XML.montaTag('CODFILIALDESTINO', CODFILIAL)
                    cData += XML.montaTag('GERADOPORLOTE', '0')
                    cData += XML.montaTag('STATUSEXPORTCONT', '0')
                    cData += XML.montaTag('GEROUCONTATRABALHO', '0')
                    cData += XML.montaTag('GERADOPORCONTATRABALHO', '0')
                    cData += XML.montaTag('HORULTIMAALTERACAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('INDUSOOBJ', '0.00')
                    cData += XML.montaTag('INTEGRADOBONUM', '0')
                    cData += XML.montaTag('FLAGPROCESSADO', '0')
                    cData += XML.montaTag('ABATIMENTOICMS', '0.0000')
                    cData += XML.montaTag('HORARIOEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('USUARIOCRIACAO', 'p_heflo')
                    cData += XML.montaTag('STSEMAIL', '0.0000')
                    cData += XML.montaTag('VALORBRUTOINTERNO', campos.valorTotal)
                    cData += XML.montaTag('VINCULADOESTOQUEFL', '0.0000')
                    cData += XML.montaTag('VRBASEINSSOUTRAEMPRESA', '0.0000')
                    cData += XML.montaTag('VALORDESCCONDICIONAL', '0.0000')
                    cData += XML.montaTag('VALORDESPCONDICIONAL', '0.0000')
                    cData += XML.montaTag('INTEGRADOAUTOMACAO', '0.0000')
                    cData += XML.montaTag('INTEGRAAPLICACAO', 'T')
                    cData += XML.montaTag('DATALANCAMENTO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('RECIBONFESTATUS', '0')
                    cData += XML.montaTag('VALORMERCADORIAS', '0.0000')
                    cData += XML.montaTag('USARATEIOVALORFIN', '1')
                    cData += XML.montaTag('CODCOLCFOAUX', '0')
                    cData += XML.montaTag('VALORRATEIOLAN', campos.valorTotal)
                    cData += XML.montaTag('RATEIOCCUSTODEPTO', campos.valorTotal)
                    cData += XML.montaTag('VALORBRUTOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROSORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORRATEIOLANORIG', campos.valorTotal)
                    cData += XML.montaTag('HISTORICOCURTO', HISTORICOCURTO)
                    cData += XML.montaTag('FLAGCONCLUSAO', '0')
                    cData += XML.montaTag('STATUSPARADIGMA', 'N')
                    cData += XML.montaTag('STATUSINTEGRACAO', 'N')
                    cData += XML.montaTag('PERCCOMISSAOVEN3', '0.0000')
                    cData += XML.montaTag('PERCCOMISSAOVEN4', '0.0000')
                    cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA)
                    cData += XML.montaTag('IDMOVHST', '-1')
                cData += '</TMOV>'
                cData += '<TNFE>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('VALORSERVICO', '0.0000')
                    cData += XML.montaTag('DEDUCAOSERVICO', '0.0000')
                    cData += XML.montaTag('ALIQUOTAISS', '0.0000')
                    cData += XML.montaTag('ISSRETIDO', '0')
                    cData += XML.montaTag('VALORISS', '0.0000')
                    cData += XML.montaTag('VALORCREDITOIPTU', '0.0000')
                    cData += XML.montaTag('BASEDECALCULO', '0.0000')
                    cData += XML.montaTag('EDITADO', '0')
                cData += '</TNFE>'
                cData += '<TMOVFISCAL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CONTRIBUINTECREDENCIADO', '0')
                    cData += XML.montaTag('OPERACAOCONSUMIDORFINAL', '0')
                    cData += XML.montaTag('OPERACAOPRESENCIAL', '0')
                cData += '</TMOVFISCAL>'
                cData += '<TMOVRATCCU>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('VALOR', campos.valorTotal)
                    cData += XML.montaTag('IDMOVRATCCU', '-1')
                cData += '</TMOVRATCCU>'
                for (let j = 0; j < listaDeParcelas.length; j++) {
                    let valorDaParcela = (listaDeParcelas[j] as { valorDaParcela: string }).valorDaParcela;
                    let vencimentoDaParcela = (listaDeParcelas[j] as { vencimentoDaParcela: string }).vencimentoDaParcela;

                    cData += '<TMOVPAGTO>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDSEQPAGTO', '-1');
                        cData += XML.montaTag('IDMOV', '-1');
                        //cData += XML.montaTag('TAXAADM', '0.0000');
                        cData += XML.montaTag('IDLAN', '-1');
                        cData += XML.montaTag('DATAVENCIMENTO', vencimentoDaParcela);
                        cData += XML.montaTag('TIPOPAGAMENTO', '1');
                        cData += XML.montaTag('VALOR', valorDaParcela);
                        //cData += XML.montaTag('DEBITOCREDITO', 'C');
                        cData += XML.montaTag('IDSEQPAGTO1', '-1');
                    cData += '</TMOVPAGTO>'
                }
                for (let i = 0; i < listaDeItens.length; i++) {
                    let codigoDaNatureza = (listaDeItens[i] as { codigoDaNatureza: string }).codigoDaNatureza;
                    let codigoDoItem = (listaDeItens[i] as { codigoDoItem: string }).codigoDoItem;
                    let qtdDoItem = (listaDeItens[i] as { qtdDoItem: string }).qtdDoItem;
                    let valorDoItem = (listaDeItens[i] as { valorDoItem: string }).valorDoItem;
                    let totalDoItem = (listaDeItens[i] as { totalDoItem: string }).totalDoItem;
            
                    cData += '<TITMMOV>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('CODFILIAL', CODFILIAL);
                        cData += XML.montaTag('NUMEROSEQUENCIAL', (i + 1).toString());
                        cData += XML.montaTag('IDPRD', codigoDoItem);
                        cData += XML.montaTag('QUANTIDADE', qtdDoItem);
                        cData += XML.montaTag('PRECOUNITARIO', valorDoItem); // PRECO UNITARIO
                        cData += XML.montaTag('PRECOTABELA', '0.0000');
                        cData += XML.montaTag('DATAEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao));
                        cData += XML.montaTag('CODUND', 'UN');
                        cData += XML.montaTag('QUANTIDADEARECEBER', qtdDoItem);
                        cData += XML.montaTag('VALORUNITARIO', '0.0000');
                        cData += XML.montaTag('VALORFINANCEIRO', '0.0000');
                        cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                        cData += XML.montaTag('ALIQORDENACAO', '0.0000');
                        cData += XML.montaTag('QUANTIDADEORIGINAL', qtdDoItem);
                        cData += XML.montaTag('CODNATUREZAITEM', campos.naturezaFiscal)
                        cData += XML.montaTag('IDNAT', '20')
                        cData += XML.montaTag('FLAG', '0');
                        cData += XML.montaTag('FATORCONVUND', '0.0000');
                        cData += XML.montaTag('VALORBRUTOITEM', '0.0000'); 
                        cData += XML.montaTag('ITEM', totalDoItem);// PRECO UNITARIO X QTD
                        cData += XML.montaTag('QUANTIDADESEPARADA', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('COMISSAOREPRES', '0.0000');
                        cData += XML.montaTag('VALORESCRITURACAO', '0.0000');
                        cData += XML.montaTag('VALORFINPEDIDO', '0.0000');
                        cData += XML.montaTag('VALOROPFRM1', '0.0000');
                        cData += XML.montaTag('VALOROPFRM2', '0.0000');
                        cData += XML.montaTag('PRECOEDITADO', '0');
                        cData += XML.montaTag('QTDEVOLUMEUNITARIO', qtdDoItem);
                        cData += XML.montaTag('CODVEN1', campos.codigoDoComprador);
                        cData += XML.montaTag('PRECOTOTALEDITADO', '0');
                        cData += XML.montaTag('VALORDESCCONDICONALITM', '0.0000');
                        cData += XML.montaTag('VALORDESPCONDICIONALITM', '0.0000');
                        cData += XML.montaTag('CODTBORCAMENTO', codigoDaNatureza);
                        cData += XML.montaTag('CODCOLTBORCAMENTO', '0');
                        cData += XML.montaTag('VALORUNTORCAMENTO', '0.0000');
                        cData += XML.montaTag('VALSERVICONFE', '0.0000');
                        cData += XML.montaTag('CODLOC', ESTOQUE);
                        cData += XML.montaTag('VALORBEM', '0.0000');
                        cData += XML.montaTag('VALORLIQUIDO', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('RATEIOCCUSTODEPTO', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('VALORBRUTOITEMORIG', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('QUANTIDADETOTAL', '0.0000');
                        cData += XML.montaTag('PRODUTOSUBSTITUTO', '0');
                        cData += XML.montaTag('PRECOUNITARIOSELEC', '0');
                        cData += XML.montaTag('QUANTIDADECONCLUIDA', qtdDoItem);
                        cData += XML.montaTag('INTEGRAAPLICACAO', "T");
                        cData += XML.montaTag('VALORBASEDEPRECIACAOBEM', '0');
                        cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA);
                        cData += XML.montaTag('IDMOVHST', '-1');
                        cData += XML.montaTag('NSEQITMMOV1', (i + 1).toString());
                    cData += '</TITMMOV>'
                    cData += '<TITMMOVRATCCU>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                        cData += XML.montaTag('VALOR', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('IDMOVRATCCU', '-1');
                    cData += '</TITMMOVRATCCU>'
                    cData += '<TITMMOVCOMPL>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                    cData += '</TITMMOVCOMPL>'
                    cData += '<TITMMOVFISCAL>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('QTDECONTRATADA', '0.0000');
                        cData += XML.montaTag('VLRTOTTRIB', '0.0000');
                        cData += XML.montaTag('AQUISICAOPAA', '0');
                        cData += XML.montaTag('POEBTRIBUTAVEL', '1');
                    cData += '</TITMMOVFISCAL>'
                    cData += tributos
                }
                cData += '<TMOVCOMPL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('MULTIPLO', 'N');
                    cData += XML.montaTag('TICKET', campos.ticketRaiz);
                    cData += XML.montaTag('LINKDOCUMENTO', (campos.anexarNotaFiscal).slice(0, 255));
                    cData += XML.montaTag('REMETENTE', campos.remetente);
                    cData += XML.montaTag('INICIOPRESTACAO', campos.inicioDaPrestacao);
                    cData += XML.montaTag('DESTINATARIO', campos.destinatario);
                    cData += XML.montaTag('TERMINOPRESTACAO', campos.terminoDaPrestacao);
                cData += '</TMOVCOMPL>'
                cData += '<TMOVTRANSP>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('RETIRAMERCADORIA', '0')
                    cData += XML.montaTag('TIPOCTE', '0')
                    cData += XML.montaTag('TOMADORTIPO', '0')
                    cData += XML.montaTag('TIPOEMITENTEMDFE', '0')
                    cData += XML.montaTag('LOTACAO', '1')
                    cData += XML.montaTag('TIPOTRANSPORTADORMDFE', '0')
                    cData += XML.montaTag('TIPOBPE', '0')
                cData += '</TMOVTRANSP>'
            cData += '</MovMovimento>'
        cData += ']]>';

        return cData;

    } catch (error) {
        console.log(error);
        throw error; 
    }

}

export function xmlMovFF(campos: any, CODCOLIGADA: string, CODFILIAL: string, SERIE: string, CODTMV: string, ESTOQUE: string, HISTORICOCURTO: string) {
    try {
        let listaDeItens = campos.itens as object[];
    
        var cData = '';
        cData += '<![CDATA['
        cData += '<MovMovimento>'
            cData += '<TMOV>'
                cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                cData += XML.montaTag('IDMOV', '-1')
                cData += XML.montaTag('CODFILIAL', CODFILIAL)
                cData += XML.montaTag('CODLOC', ESTOQUE)
                cData += XML.montaTag('CODLOCDESTINO', ESTOQUE)
                cData += XML.montaTag('CODCFO', campos.codigoDoFornecedor)
                cData += XML.montaTag('NUMEROMOV', '-1')
                cData += XML.montaTag('SERIE', SERIE)
                cData += XML.montaTag('CODTMV', CODTMV)
                cData += XML.montaTag('TIPO', 'A')
                cData += XML.montaTag('MOVIMPRESSO', '0')
                cData += XML.montaTag('DOCIMPRESSO', '0')
                cData += XML.montaTag('FATIMPRESSA', '0')
                cData += XML.montaTag('DATAEMISSAO', DATE.getDateTime())
                cData += XML.montaTag('COMISSAOREPRES', '0.0000')
                cData += XML.montaTag('CODCPG', campos.codigoDaFormaPagamento)
                cData += XML.montaTag('VALORBRUTO', campos.valorTotal)
                cData += XML.montaTag('VALORLIQUIDO', campos.valorTotal)
                cData += XML.montaTag('VALOROUTROS', campos.valorTotal)
                cData += XML.montaTag('PERCENTUALFRETE', '0.0000')
                cData += XML.montaTag('VALORFRETE', '0.0000')
                cData += XML.montaTag('PERCENTUALDESC', '0.0000')
                cData += XML.montaTag('VALORDESC', '0.0000')
                cData += XML.montaTag('PERCENTUALDESP', '0.0000')
                cData += XML.montaTag('VALORDESP', '0.0000')
                cData += XML.montaTag('PERCCOMISSAO', '0.0000')
                cData += XML.montaTag('CODMEN', '01')
                cData += XML.montaTag('PESOLIQUIDO', '0.0000')
                cData += XML.montaTag('PESOBRUTO', '0.0000')
                cData += XML.montaTag('IDMOVLCTFLUXUS', '-1')
                cData += XML.montaTag('CODMOEVALORLIQUIDO', 'R$')
                cData += XML.montaTag('DATAMOVIMENTO', DATE.getDateTime())
                cData += XML.montaTag('GEROUFATURA', '0')
                cData += XML.montaTag('NUMEROLCTABERTO', '1')
                cData += XML.montaTag('CODCFOAUX', campos.codigoDoFornecedor)
                cData += XML.montaTag('VALORRECEBIDO', campos.valorTotal)
                cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                cData += XML.montaTag('CODVEN1', campos.codigoDoComprador)
                cData += XML.montaTag('PERCCOMISSAOVEN2', '0.0000')
                cData += XML.montaTag('CODCOLCFO', '0')
                cData += XML.montaTag('CODUSUARIO', 'p_heflo')
                cData += XML.montaTag('CODFILIALDESTINO', CODFILIAL)
                cData += XML.montaTag('GERADOPORLOTE', '0')
                cData += XML.montaTag('STATUSEXPORTCONT', '0')
                cData += XML.montaTag('GEROUCONTATRABALHO', '0')
                cData += XML.montaTag('GERADOPORCONTATRABALHO', '0')
                cData += XML.montaTag('HORULTIMAALTERACAO', DATE.getDateTime())
                cData += XML.montaTag('INDUSOOBJ', '0.00')
                cData += XML.montaTag('INTEGRADOBONUM', '0')
                cData += XML.montaTag('FLAGPROCESSADO', '0')
                cData += XML.montaTag('ABATIMENTOICMS', '0.0000')
                cData += XML.montaTag('HORARIOEMISSAO', DATE.getDateTime())
                cData += XML.montaTag('USUARIOCRIACAO', 'p_heflo')
                cData += XML.montaTag('STSEMAIL', '0.0000')
                cData += XML.montaTag('VALORBRUTOINTERNO', campos.valorTotal)
                cData += XML.montaTag('VINCULADOESTOQUEFL', '0.0000')
                cData += XML.montaTag('VRBASEINSSOUTRAEMPRESA', '0.0000')
                cData += XML.montaTag('VALORDESCCONDICIONAL', '0.0000')
                cData += XML.montaTag('VALORDESPCONDICIONAL', '0.0000')
                cData += XML.montaTag('INTEGRADOAUTOMACAO', '0.0000')
                cData += XML.montaTag('INTEGRAAPLICACAO', 'T')
                cData += XML.montaTag('DATALANCAMENTO', DATE.getDateTime())
                cData += XML.montaTag('RECIBONFESTATUS', '0')
                cData += XML.montaTag('VALORMERCADORIAS', '0.0000')
                cData += XML.montaTag('USARATEIOVALORFIN', '1')
                cData += XML.montaTag('CODCOLCFOAUX', '0')
                cData += XML.montaTag('VALORRATEIOLAN', campos.valorTotal)
                cData += XML.montaTag('RATEIOCCUSTODEPTO', campos.valorTotal)
                cData += XML.montaTag('VALORBRUTOORIG', campos.valorTotal)
                cData += XML.montaTag('VALORLIQUIDOORIG', campos.valorTotal)
                cData += XML.montaTag('VALOROUTROSORIG', campos.valorTotal)
                cData += XML.montaTag('VALORRATEIOLANORIG', campos.valorTotal)
                cData += XML.montaTag('HISTORICOCURTO', HISTORICOCURTO)
                cData += XML.montaTag('FLAGCONCLUSAO', '0')
                cData += XML.montaTag('STATUSPARADIGMA', 'N')
                cData += XML.montaTag('STATUSINTEGRACAO', 'N')
                cData += XML.montaTag('PERCCOMISSAOVEN3', '0.0000')
                cData += XML.montaTag('PERCCOMISSAOVEN4', '0.0000')
                cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA)
                cData += XML.montaTag('IDMOVHST', '-1')
            cData += '</TMOV>'
            cData += '<TNFE>'
                cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                cData += XML.montaTag('IDMOV', '-1')
                cData += XML.montaTag('VALORSERVICO', '0.0000')
                cData += XML.montaTag('DEDUCAOSERVICO', '0.0000')
                cData += XML.montaTag('ALIQUOTAISS', '0.0000')
                cData += XML.montaTag('ISSRETIDO', '0')
                cData += XML.montaTag('VALORISS', '0.0000')
                cData += XML.montaTag('VALORCREDITOIPTU', '0.0000')
                cData += XML.montaTag('BASEDECALCULO', '0.0000')
                cData += XML.montaTag('EDITADO', '0')
            cData += '</TNFE>'
            cData += '<TMOVFISCAL>'
                cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                cData += XML.montaTag('IDMOV', '-1')
                cData += XML.montaTag('CONTRIBUINTECREDENCIADO', '0')
                cData += XML.montaTag('OPERACAOCONSUMIDORFINAL', '0')
                cData += XML.montaTag('OPERACAOPRESENCIAL', '0')
            cData += '</TMOVFISCAL>'
            cData += '<TMOVRATCCU>'
                cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                cData += XML.montaTag('IDMOV', '-1')
                cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                cData += XML.montaTag('VALOR', campos.valorTotal)
                cData += XML.montaTag('IDMOVRATCCU', '-1')
            cData += '</TMOVRATCCU>'
            cData += '<TMOVPAGTO>'
                cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                cData += XML.montaTag('IDSEQPAGTO', '-1');
                cData += XML.montaTag('IDMOV', '-1');
                cData += XML.montaTag('CODCOLCFODEFAULT', '0');
                cData += XML.montaTag('TIPOFORMAPAGTO', '3');
                cData += XML.montaTag('TAXAADM', '0.0000');
                cData += XML.montaTag('CODCXA', '003');
                cData += XML.montaTag('CODCOLCXA', '0');
                cData += XML.montaTag('IDLAN', '-1');
                cData += XML.montaTag('IDFORMAPAGTO', '2');
                cData += XML.montaTag('DATAVENCIMENTO', DATE.getDateTime());
                cData += XML.montaTag('TIPOPAGAMENTO', '1');
                cData += XML.montaTag('VALOR', campos.valorTotal);
                cData += XML.montaTag('DEBITOCREDITO', 'C');
                cData += XML.montaTag('IDSEQPAGTO1', '-1');
            cData += '</TMOVPAGTO>'

            for (let i = 0; i < listaDeItens.length; i++) {
                let codigoDaNatureza = (listaDeItens[i] as { codigoDaNatureza: string }).codigoDaNatureza;
                let codigoDoItem = (listaDeItens[i] as { codigoDoItem: string }).codigoDoItem;
                let qtdDoItem = (listaDeItens[i] as { qtdDoItem: string }).qtdDoItem;
                let valorDoItem = (listaDeItens[i] as { valorDoItem: string }).valorDoItem;
                let totalDoItem = (listaDeItens[i] as { totalDoItem: string }).totalDoItem;

                cData += '<TITMMOV>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                    cData += XML.montaTag('CODFILIAL', CODFILIAL);
                    cData += XML.montaTag('NUMEROSEQUENCIAL', (i + 1).toString());
                    cData += XML.montaTag('IDPRD', codigoDoItem);
                    cData += XML.montaTag('QUANTIDADE', qtdDoItem);
                    cData += XML.montaTag('PRECOUNITARIO', valorDoItem); // PRECO UNITARIO
                    cData += XML.montaTag('PRECOTABELA', '0.0000');
                    cData += XML.montaTag('DATAEMISSAO', DATE.getDateTime());
                    cData += XML.montaTag('CODUND', 'UN');
                    cData += XML.montaTag('QUANTIDADEARECEBER', qtdDoItem);
                    cData += XML.montaTag('VALORUNITARIO', '0.0000');
                    cData += XML.montaTag('VALORFINANCEIRO', '0.0000');
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                    cData += XML.montaTag('ALIQORDENACAO', '0.0000');
                    cData += XML.montaTag('QUANTIDADEORIGINAL', qtdDoItem);
                    cData += XML.montaTag('FLAG', '0');
                    cData += XML.montaTag('FATORCONVUND', '0.0000');
                    cData += XML.montaTag('VALORBRUTOITEM', '0.0000'); 
                    cData += XML.montaTag('VALORTOTALITEM', totalDoItem);// PRECO UNITARIO X QTD
                    cData += XML.montaTag('QUANTIDADESEPARADA', totalDoItem); // PRECO UNITARIO X QTD
                    cData += XML.montaTag('COMISSAOREPRES', '0.0000');
                    cData += XML.montaTag('VALORESCRITURACAO', '0.0000');
                    cData += XML.montaTag('VALORFINPEDIDO', '0.0000');
                    cData += XML.montaTag('VALOROPFRM1', '0.0000');
                    cData += XML.montaTag('VALOROPFRM2', '0.0000');
                    cData += XML.montaTag('PRECOEDITADO', '0');
                    cData += XML.montaTag('QTDEVOLUMEUNITARIO', qtdDoItem);
                    cData += XML.montaTag('CODVEN1', campos.codigoDoComprador);
                    cData += XML.montaTag('PRECOTOTALEDITADO', '0');
                    cData += XML.montaTag('VALORDESCCONDICONALITM', '0.0000');
                    cData += XML.montaTag('VALORDESPCONDICIONALITM', '0.0000');
                    cData += XML.montaTag('CODTBORCAMENTO', codigoDaNatureza);
                    cData += XML.montaTag('CODCOLTBORCAMENTO', '0');
                    cData += XML.montaTag('VALORUNTORCAMENTO', '0.0000');
                    cData += XML.montaTag('VALSERVICONFE', '0.0000');
                    cData += XML.montaTag('CODLOC', ESTOQUE);
                    cData += XML.montaTag('VALORBEM', '0.0000');
                    cData += XML.montaTag('VALORLIQUIDO', totalDoItem); // PRECO UNITARIO X QTD
                    cData += XML.montaTag('RATEIOCCUSTODEPTO', totalDoItem); // PRECO UNITARIO X QTD
                    cData += XML.montaTag('VALORBRUTOITEMORIG', totalDoItem); // PRECO UNITARIO X QTD
                    cData += XML.montaTag('QUANTIDADETOTAL', '0.0000');
                    cData += XML.montaTag('PRODUTOSUBSTITUTO', '0');
                    cData += XML.montaTag('PRECOUNITARIOSELEC', '0');
                    cData += XML.montaTag('QUANTIDADECONCLUIDA', qtdDoItem);
                    cData += XML.montaTag('INTEGRAAPLICACAO', "T");
                    cData += XML.montaTag('VALORBASEDEPRECIACAOBEM', '0');
                    cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA);
                    cData += XML.montaTag('IDMOVHST', '-1');
                    cData += XML.montaTag('NSEQITMMOV1', (i + 1).toString());
                cData += '</TITMMOV>'
                cData += '<TITMMOVRATCCU>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                    cData += XML.montaTag('VALOR', totalDoItem); // PRECO UNITARIO X QTD
                    cData += XML.montaTag('IDMOVRATCCU', '-1');
                cData += '</TITMMOVRATCCU>'
                cData += '<TITMMOVCOMPL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                cData += '</TITMMOVCOMPL>'
                // for (let j = 0; j < tributos.length; j++) {
                //     cData += '<TTRBITMMOV>';
                //         cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA); 
                //         cData += XML.montaTag('IDMOV', '-1');  
                //         cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());   
                //         cData += XML.montaTag('CODTRB', tributos[j]);
                //         cData += XML.montaTag('BASEDECALCULO', totalDoItem);
                //         cData += XML.montaTag('VALOR', '0.0000');    
                //         cData += XML.montaTag('FATORREDUCAO', '0.0000');
                //         cData += XML.montaTag('FATORSUBSTTRIB', '0.0000');
                //         cData += XML.montaTag('BASEDECALCULOCALCULADA', totalDoItem);
                //         cData += XML.montaTag('EDITADO', '0');
                //         cData += XML.montaTag('PERCDIFERIMENTOPARCIALICMS', '0.0000');
                //         cData += XML.montaTag('BASECHEIA', '0.0000');
                //     cData += '</TTRBITMMOV>';
                // }
                cData += '<TITMMOVFISCAL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                    cData += XML.montaTag('QTDECONTRATADA', '0.0000');
                    cData += XML.montaTag('VLRTOTTRIB', '0.0000');
                    cData += XML.montaTag('AQUISICAOPAA', '0');
                    cData += XML.montaTag('POEBTRIBUTAVEL', '1');
                cData += '</TITMMOVFISCAL>';
            }

            cData += '<TMOVCOMPL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('MULTIPLO', 'N');
                    cData += XML.montaTag('TICKET', campos.ticketRaiz);
                    cData += XML.montaTag('LINKDOCUMENTO', (campos.anexarNotaFiscal).slice(0, 255));
                    cData += XML.montaTag('REMETENTE', campos.remetente);
                    cData += XML.montaTag('INICIOPRESTACAO', campos.inicioDaPrestacao);
                    cData += XML.montaTag('DESTINATARIO', campos.destinatario);
                    cData += XML.montaTag('TERMINOPRESTACAO', campos.terminoDaPrestacao);
            cData += '</TMOVCOMPL>'
            cData += '<TMOVTRANSP>'
                cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                cData += XML.montaTag('IDMOV', '-1')
                cData += XML.montaTag('RETIRAMERCADORIA', '0')
                cData += XML.montaTag('TIPOCTE', '0')
                cData += XML.montaTag('TOMADORTIPO', '0')
                cData += XML.montaTag('TIPOEMITENTEMDFE', '0')
                cData += XML.montaTag('LOTACAO', '1')
                cData += XML.montaTag('TIPOTRANSPORTADORMDFE', '0')
                cData += XML.montaTag('TIPOBPE', '0')
            cData += '</TMOVTRANSP>'
        cData += '</MovMovimento>'
    cData += ']]>';

    return cData;
        
    } catch (error) {
        console.log(error);
        throw error; 
    }

}

export function xmlMovRE(campos: any, CODCOLIGADA: string, CODFILIAL: string, SERIE: string, CODTMV: string, ESTOQUE: string, HISTORICOCURTO: string) {
    try {
        let listaDeItens = campos.itens as object[];
    
        var cData = '';
        cData += '<![CDATA['
            cData += '<MovMovimento>'
                cData += '<TMOV>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODFILIAL', CODFILIAL)
                    cData += XML.montaTag('CODLOC', ESTOQUE)
                    cData += XML.montaTag('CODLOCDESTINO', ESTOQUE)
                    cData += XML.montaTag('CODCFO', campos.codigoDoFornecedor)
                    cData += XML.montaTag('NUMEROMOV', '-1')
                    cData += XML.montaTag('SERIE', 'PR')
                    cData += XML.montaTag('CODTMV', CODTMV)
                    cData += XML.montaTag('TIPO', 'A')
                    cData += XML.montaTag('MOVIMPRESSO', '0')
                    cData += XML.montaTag('DOCIMPRESSO', '0')
                    cData += XML.montaTag('FATIMPRESSA', '0')
                    cData += XML.montaTag('DATAEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('COMISSAOREPRES', '0.0000')
                    cData += XML.montaTag('CODCPG', campos.codigoDaFormaPagamento)
                    cData += XML.montaTag('VALORBRUTO', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDO', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROS', campos.valorTotal)
                    cData += XML.montaTag('PERCENTUALFRETE', '0.0000')
                    cData += XML.montaTag('VALORFRETE', '0.0000')
                    cData += XML.montaTag('PERCENTUALDESC', '0.0000')
                    cData += XML.montaTag('VALORDESC', '0.0000')
                    cData += XML.montaTag('PERCENTUALDESP', '0.0000')
                    cData += XML.montaTag('VALORDESP', '0.0000')
                    cData += XML.montaTag('PERCCOMISSAO', '0.0000')
                    cData += XML.montaTag('CODMEN', '01')
                    cData += XML.montaTag('PESOLIQUIDO', '0.0000')
                    cData += XML.montaTag('PESOBRUTO', '0.0000')
                    cData += XML.montaTag('IDMOVLCTFLUXUS', '-1')
                    cData += XML.montaTag('CODMOEVALORLIQUIDO', 'R$')
                    cData += XML.montaTag('DATAMOVIMENTO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('GEROUFATURA', '0')
                    cData += XML.montaTag('NUMEROLCTABERTO', '1')
                    cData += XML.montaTag('CODCFOAUX', campos.codigoDoFornecedor)
                    cData += XML.montaTag('VALORRECEBIDO', campos.valorTotal)
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('CODVEN1', campos.codigoDoComprador)
                    cData += XML.montaTag('PERCCOMISSAOVEN2', '0.0000')
                    cData += XML.montaTag('CODCOLCFO', '0')
                    cData += XML.montaTag('CODUSUARIO', 'p_heflo')
                    cData += XML.montaTag('CODFILIALDESTINO', CODFILIAL)
                    cData += XML.montaTag('GERADOPORLOTE', '0')
                    cData += XML.montaTag('STATUSEXPORTCONT', '0')
                    cData += XML.montaTag('GEROUCONTATRABALHO', '0')
                    cData += XML.montaTag('GERADOPORCONTATRABALHO', '0')
                    cData += XML.montaTag('HORULTIMAALTERACAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('INDUSOOBJ', '0.00')
                    cData += XML.montaTag('INTEGRADOBONUM', '0')
                    cData += XML.montaTag('FLAGPROCESSADO', '0')
                    cData += XML.montaTag('ABATIMENTOICMS', '0.0000')
                    cData += XML.montaTag('HORARIOEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('USUARIOCRIACAO', 'p_heflo')
                    cData += XML.montaTag('STSEMAIL', '0.0000')
                    cData += XML.montaTag('VALORBRUTOINTERNO', campos.valorTotal)
                    cData += XML.montaTag('VINCULADOESTOQUEFL', '0.0000')
                    cData += XML.montaTag('VRBASEINSSOUTRAEMPRESA', '0.0000')
                    cData += XML.montaTag('VALORDESCCONDICIONAL', '0.0000')
                    cData += XML.montaTag('VALORDESPCONDICIONAL', '0.0000')
                    cData += XML.montaTag('INTEGRADOAUTOMACAO', '0.0000')
                    cData += XML.montaTag('INTEGRAAPLICACAO', 'T')
                    cData += XML.montaTag('DATALANCAMENTO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('RECIBONFESTATUS', '0')
                    cData += XML.montaTag('VALORMERCADORIAS', '0.0000')
                    cData += XML.montaTag('USARATEIOVALORFIN', '1')
                    cData += XML.montaTag('CODCOLCFOAUX', '0')
                    cData += XML.montaTag('VALORRATEIOLAN', campos.valorTotal)
                    cData += XML.montaTag('RATEIOCCUSTODEPTO', campos.valorTotal)
                    cData += XML.montaTag('VALORBRUTOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROSORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORRATEIOLANORIG', campos.valorTotal)
                    cData += XML.montaTag('HISTORICOCURTO', HISTORICOCURTO)
                    cData += XML.montaTag('FLAGCONCLUSAO', '0')
                    cData += XML.montaTag('STATUSPARADIGMA', 'N')
                    cData += XML.montaTag('STATUSINTEGRACAO', 'N')
                    cData += XML.montaTag('PERCCOMISSAOVEN3', '0.0000')
                    cData += XML.montaTag('PERCCOMISSAOVEN4', '0.0000')
                    cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA)
                    cData += XML.montaTag('IDMOVHST', '-1')
                cData += '</TMOV>'
                cData += '<TNFE>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('VALORSERVICO', '0.0000')
                    cData += XML.montaTag('DEDUCAOSERVICO', '0.0000')
                    cData += XML.montaTag('ALIQUOTAISS', '0.0000')
                    cData += XML.montaTag('ISSRETIDO', '0')
                    cData += XML.montaTag('VALORISS', '0.0000')
                    cData += XML.montaTag('VALORCREDITOIPTU', '0.0000')
                    cData += XML.montaTag('BASEDECALCULO', '0.0000')
                    cData += XML.montaTag('EDITADO', '0')
                cData += '</TNFE>'
                cData += '<TMOVFISCAL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CONTRIBUINTECREDENCIADO', '0')
                    cData += XML.montaTag('OPERACAOCONSUMIDORFINAL', '0')
                    cData += XML.montaTag('OPERACAOPRESENCIAL', '0')
                cData += '</TMOVFISCAL>'
                cData += '<TMOVRATCCU>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('VALOR', campos.valorTotal)
                    cData += XML.montaTag('IDMOVRATCCU', '-1')
                cData += '</TMOVRATCCU>'
                // cData += '<TMOVPAGTO>'
                //     cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                //     cData += XML.montaTag('IDSEQPAGTO', '-1');
                //     cData += XML.montaTag('IDMOV', '-1');
                //     cData += XML.montaTag('TAXAADM', '0.0000');
                //     cData += XML.montaTag('IDLAN', '-1');
                //     cData += XML.montaTag('DATAVENCIMENTO', DATE.getDateTime());
                //     cData += XML.montaTag('TIPOPAGAMENTO', '1');
                //     cData += XML.montaTag('VALOR', campos.valorTotal);
                //     cData += XML.montaTag('DEBITOCREDITO', 'C');
                //     cData += XML.montaTag('IDSEQPAGTO1', '-1');
                // cData += '</TMOVPAGTO>'
                for (let i = 0; i < listaDeItens.length; i++) {
                    let codigoDaNatureza = (listaDeItens[i] as { codigoDaNatureza: string }).codigoDaNatureza;
                    let codigoDoItem = (listaDeItens[i] as { codigoDoItem: string }).codigoDoItem;
                    let qtdDoItem = (listaDeItens[i] as { qtdDoItem: string }).qtdDoItem;
                    let valorDoItem = (listaDeItens[i] as { valorDoItem: string }).valorDoItem;
                    let totalDoItem = (listaDeItens[i] as { totalDoItem: string }).totalDoItem;
            
                    cData += '<TITMMOV>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('CODFILIAL', CODFILIAL);
                        cData += XML.montaTag('NUMEROSEQUENCIAL', (i + 1).toString());
                        cData += XML.montaTag('IDPRD', codigoDoItem);
                        cData += XML.montaTag('QUANTIDADE', qtdDoItem);
                        cData += XML.montaTag('PRECOUNITARIO', valorDoItem); // PRECO UNITARIO
                        cData += XML.montaTag('PRECOTABELA', '0.0000');
                        cData += XML.montaTag('DATAEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao));
                        cData += XML.montaTag('CODUND', 'UN');
                        cData += XML.montaTag('QUANTIDADEARECEBER', qtdDoItem);
                        cData += XML.montaTag('VALORUNITARIO', '0.0000');
                        cData += XML.montaTag('VALORFINANCEIRO', '0.0000');
                        cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                        cData += XML.montaTag('ALIQORDENACAO', '0.0000');
                        cData += XML.montaTag('QUANTIDADEORIGINAL', qtdDoItem);
                        cData += XML.montaTag('FLAG', '0');
                        cData += XML.montaTag('FATORCONVUND', '0.0000');
                        cData += XML.montaTag('VALORBRUTOITEM', '0.0000'); 
                        cData += XML.montaTag('ITEM', totalDoItem);// PRECO UNITARIO X QTD
                        cData += XML.montaTag('QUANTIDADESEPARADA', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('COMISSAOREPRES', '0.0000');
                        cData += XML.montaTag('VALORESCRITURACAO', '0.0000');
                        cData += XML.montaTag('VALORFINPEDIDO', '0.0000');
                        cData += XML.montaTag('VALOROPFRM1', '0.0000');
                        cData += XML.montaTag('VALOROPFRM2', '0.0000');
                        cData += XML.montaTag('PRECOEDITADO', '0');
                        cData += XML.montaTag('QTDEVOLUMEUNITARIO', qtdDoItem);
                        cData += XML.montaTag('CODVEN1', campos.codigoDoComprador);
                        cData += XML.montaTag('PRECOTOTALEDITADO', '0');
                        cData += XML.montaTag('VALORDESCCONDICONALITM', '0.0000');
                        cData += XML.montaTag('VALORDESPCONDICIONALITM', '0.0000');
                        cData += XML.montaTag('CODTBORCAMENTO', codigoDaNatureza);
                        cData += XML.montaTag('CODCOLTBORCAMENTO', '0');
                        cData += XML.montaTag('VALORUNTORCAMENTO', '0.0000');
                        cData += XML.montaTag('VALSERVICONFE', '0.0000');
                        cData += XML.montaTag('CODLOC', ESTOQUE);
                        cData += XML.montaTag('VALORBEM', '0.0000');
                        cData += XML.montaTag('VALORLIQUIDO', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('RATEIOCCUSTODEPTO', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('VALORBRUTOITEMORIG', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('QUANTIDADETOTAL', '0.0000');
                        cData += XML.montaTag('PRODUTOSUBSTITUTO', '0');
                        cData += XML.montaTag('PRECOUNITARIOSELEC', '0');
                        cData += XML.montaTag('QUANTIDADECONCLUIDA', qtdDoItem);
                        cData += XML.montaTag('INTEGRAAPLICACAO', "T");
                        cData += XML.montaTag('VALORBASEDEPRECIACAOBEM', '0');
                        cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA);
                        cData += XML.montaTag('IDMOVHST', '-1');
                        cData += XML.montaTag('NSEQITMMOV1', (i + 1).toString());
                    cData += '</TITMMOV>'
                    cData += '<TITMMOVRATCCU>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                        cData += XML.montaTag('VALOR', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('IDMOVRATCCU', '-1');
                    cData += '</TITMMOVRATCCU>'
                    cData += '<TITMMOVCOMPL>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                    cData += '</TITMMOVCOMPL>'
                    // if(OC !== '' || AD !== ''){
                    //     cData += '<TITMMOVRELAC>'
                    //         cData += XML.montaTag('IDMOVORIGEM', OC);
                    //         cData += XML.montaTag('NSEQITMMOVORIGEM', (i + 1).toString());
                    //         cData += XML.montaTag('CODCOLORIGEM', CODCOLIGADA);
                    //         cData += XML.montaTag('IDMOVDESTINO', '-1');
                    //         cData += XML.montaTag('NSEQITMMOVDESTINO', (i + 1).toString());
                    //         cData += XML.montaTag('CODCOLDESTINO', CODCOLIGADA);
                    //         cData += XML.montaTag('QUANTIDADE', qtdDoItem);
                    //     cData += '</TITMMOVRELAC>'
                    // }
                    // for (let j = 0; j < tributos.length; j++) {
                    //     cData += '<TTRBITMMOV>';
                    //         cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA); 
                    //         cData += XML.montaTag('IDMOV', '-1');  
                    //         cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());   
                    //         cData += XML.montaTag('CODTRB', tributos[j]);
                    //         cData += XML.montaTag('BASEDECALCULO', totalDoItem);
                    //         cData += XML.montaTag('VALOR', '0.0000');    
                    //         cData += XML.montaTag('FATORREDUCAO', '0.0000');
                    //         cData += XML.montaTag('FATORSUBSTTRIB', '0.0000');
                    //         cData += XML.montaTag('BASEDECALCULOCALCULADA', totalDoItem);
                    //         cData += XML.montaTag('EDITADO', '0');
                    //         cData += XML.montaTag('PERCDIFERIMENTOPARCIALICMS', '0.0000');
                    //         cData += XML.montaTag('BASECHEIA', '0.0000');
                    //     cData += '</TTRBITMMOV>';
                    // }
                    cData += '<TITMMOVFISCAL>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('QTDECONTRATADA', '0.0000');
                        cData += XML.montaTag('VLRTOTTRIB', '0.0000');
                        cData += XML.montaTag('AQUISICAOPAA', '0');
                        cData += XML.montaTag('POEBTRIBUTAVEL', '1');
                    cData += '</TITMMOVFISCAL>';
                }
                cData += '<TMOVCOMPL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('MULTIPLO', 'N')
                    cData += XML.montaTag('HEFLO', campos.ticketRaiz)
                cData += '</TMOVCOMPL>'
                cData += '<TMOVTRANSP>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('RETIRAMERCADORIA', '0')
                    cData += XML.montaTag('TIPOCTE', '0')
                    cData += XML.montaTag('TOMADORTIPO', '0')
                    cData += XML.montaTag('TIPOEMITENTEMDFE', '0')
                    cData += XML.montaTag('LOTACAO', '1')
                    cData += XML.montaTag('TIPOTRANSPORTADORMDFE', '0')
                    cData += XML.montaTag('TIPOBPE', '0')
                cData += '</TMOVTRANSP>'
            cData += '</MovMovimento>'
        cData += ']]>';

        return cData;

    } catch (error) {
        console.log(error);
        throw error; 
    }

}

export function xmlMovTM(campos: any, CODCOLIGADA: string, CODFILIAL: string, SERIE: string, CODTMV: string, ESTOQUE: string, HISTORICOCURTO: string) {
    try {
        //let listaDeItens = campos.itens as object[];

        var listaDeItens = [{
            codigoDaNatureza: '02.07.00072',
            codigoDoItem:'116181',
            qtdDoItem:'1',
            valorDoItem: campos.valorTotal,
            totalDoItem: campos.valorTotal
        }];

        let listaDeParcelas = campos.parcelas as object[];
    
        var cData = '';
        cData += '<![CDATA['
            cData += '<MovMovimento>'
                cData += '<TMOV>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODFILIAL', CODFILIAL)
                    cData += XML.montaTag('CODLOC', ESTOQUE)
                    cData += XML.montaTag('CODLOCDESTINO', ESTOQUE)
                    cData += XML.montaTag('CODCFO', campos.codigoDoFornecedor)
                    cData += XML.montaTag('NUMEROMOV', (campos.numeroDaNF).slice(0, 9))
                    cData += XML.montaTag('SERIE', SERIE)
                    cData += XML.montaTag('CODTMV', CODTMV)
                    cData += XML.montaTag('TIPO', 'A')
                    cData += XML.montaTag('MOVIMPRESSO', '0')
                    cData += XML.montaTag('DOCIMPRESSO', '0')
                    cData += XML.montaTag('FATIMPRESSA', '0')
                    cData += XML.montaTag('DATAEMISSAO', DATE.getDateTime())
                    cData += XML.montaTag('COMISSAOREPRES', '0.0000')
                    cData += XML.montaTag('CODCPG', campos.codigoDaFormaPagamento)
                    cData += XML.montaTag('VALORBRUTO', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDO', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROS', campos.valorTotal)
                    cData += XML.montaTag('FRETECIFOUFOB', campos.tipoDeFrete)
                    cData += XML.montaTag('PERCENTUALFRETE', '0.0000')
                    cData += XML.montaTag('VALORFRETE', campos.valorDoFrete)
                    cData += XML.montaTag('PERCENTUALDESC', '0.0000')
                    cData += XML.montaTag('VALORDESC', '0.0000')
                    cData += XML.montaTag('PERCENTUALDESP', '0.0000')
                    cData += XML.montaTag('VALORDESP', '0.0000')
                    cData += XML.montaTag('PERCCOMISSAO', '0.0000')
                    cData += XML.montaTag('CODMEN', '01')
                    cData += XML.montaTag('PESOLIQUIDO', '0.0000')
                    cData += XML.montaTag('PESOBRUTO', '0.0000')
                    cData += XML.montaTag('IDMOVLCTFLUXUS', '-1')
                    cData += XML.montaTag('CODMOEVALORLIQUIDO', 'R$')
                    cData += XML.montaTag('DATAMOVIMENTO', DATE.getDateTime())
                    cData += XML.montaTag('GEROUFATURA', '0')
                    cData += XML.montaTag('NUMEROLCTABERTO', '1')
                    cData += XML.montaTag('CODCFOAUX', campos.codigoDoFornecedor)
                    cData += XML.montaTag('VALORRECEBIDO', campos.valorTotal)
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('CODVEN1', campos.codigoDoComprador)
                    cData += XML.montaTag('PERCCOMISSAOVEN2', '0.0000')
                    cData += XML.montaTag('CODCOLCFO', '0')
                    cData += XML.montaTag('CODUSUARIO', 'p_heflo')
                    cData += XML.montaTag('CODFILIALDESTINO', CODFILIAL)
                    cData += XML.montaTag('GERADOPORLOTE', '0')
                    cData += XML.montaTag('STATUSEXPORTCONT', '0')
                    cData += XML.montaTag('GEROUCONTATRABALHO', '0')
                    cData += XML.montaTag('GERADOPORCONTATRABALHO', '0')
                    cData += XML.montaTag('HORULTIMAALTERACAO', DATE.getDateTime())
                    cData += XML.montaTag('INDUSOOBJ', '0.00')
                    cData += XML.montaTag('INTEGRADOBONUM', '0')
                    cData += XML.montaTag('FLAGPROCESSADO', '0')
                    cData += XML.montaTag('ABATIMENTOICMS', '0.0000')
                    cData += XML.montaTag('HORARIOEMISSAO', DATE.getDateTime())
                    cData += XML.montaTag('USUARIOCRIACAO', 'p_heflo')
                    cData += XML.montaTag('STSEMAIL', '0.0000')
                    cData += XML.montaTag('VALORBRUTOINTERNO', campos.valorTotal)
                    cData += XML.montaTag('VINCULADOESTOQUEFL', '0.0000')
                    cData += XML.montaTag('VRBASEINSSOUTRAEMPRESA', '0.0000')
                    cData += XML.montaTag('VALORDESCCONDICIONAL', '0.0000')
                    cData += XML.montaTag('VALORDESPCONDICIONAL', '0.0000')
                    cData += XML.montaTag('INTEGRADOAUTOMACAO', '0.0000')
                    cData += XML.montaTag('INTEGRAAPLICACAO', 'T')
                    cData += XML.montaTag('DATALANCAMENTO', DATE.getDateTime())
                    cData += XML.montaTag('RECIBONFESTATUS', '0')
                    cData += XML.montaTag('VALORMERCADORIAS', '0.0000')
                    cData += XML.montaTag('USARATEIOVALORFIN', '1')
                    cData += XML.montaTag('CODCOLCFOAUX', '0')
                    cData += XML.montaTag('VALORRATEIOLAN', campos.valorTotal)
                    cData += XML.montaTag('RATEIOCCUSTODEPTO', campos.valorTotal)
                    cData += XML.montaTag('VALORBRUTOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROSORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORRATEIOLANORIG', campos.valorTotal)
                    cData += XML.montaTag('HISTORICOCURTO', HISTORICOCURTO)
                    cData += XML.montaTag('FLAGCONCLUSAO', '0')
                    cData += XML.montaTag('STATUSPARADIGMA', 'N')
                    cData += XML.montaTag('STATUSINTEGRACAO', 'N')
                    cData += XML.montaTag('PERCCOMISSAOVEN3', '0.0000')
                    cData += XML.montaTag('PERCCOMISSAOVEN4', '0.0000')
                    cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA)
                    cData += XML.montaTag('IDMOVHST', '-1')
                cData += '</TMOV>'
                cData += '<TNFE>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('VALORSERVICO', '0.0000')
                    cData += XML.montaTag('DEDUCAOSERVICO', '0.0000')
                    cData += XML.montaTag('ALIQUOTAISS', '0.0000')
                    cData += XML.montaTag('ISSRETIDO', '0')
                    cData += XML.montaTag('VALORISS', '0.0000')
                    cData += XML.montaTag('VALORCREDITOIPTU', '0.0000')
                    cData += XML.montaTag('BASEDECALCULO', '0.0000')
                    cData += XML.montaTag('EDITADO', '0')
                cData += '</TNFE>'
                cData += '<TMOVFISCAL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CONTRIBUINTECREDENCIADO', '0')
                    cData += XML.montaTag('OPERACAOCONSUMIDORFINAL', '0')
                    cData += XML.montaTag('OPERACAOPRESENCIAL', '0')
                cData += '</TMOVFISCAL>'
                cData += '<TMOVRATCCU>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('VALOR', campos.valorTotal)
                    cData += XML.montaTag('IDMOVRATCCU', '-1')
                cData += '</TMOVRATCCU>'
                for (let j = 0; j < listaDeParcelas.length; j++) {
                    let valorDaParcela = (listaDeParcelas[j] as { valorDaParcela: string }).valorDaParcela;
                    let vencimentoDaParcela = (listaDeParcelas[j] as { vencimentoDaParcela: string }).vencimentoDaParcela;

                    cData += '<TMOVPAGTO>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDSEQPAGTO', '-1');
                        cData += XML.montaTag('IDMOV', '-1');
                        //cData += XML.montaTag('TAXAADM', '0.0000');
                        cData += XML.montaTag('IDLAN', '-1');
                        cData += XML.montaTag('DATAVENCIMENTO', vencimentoDaParcela);
                        cData += XML.montaTag('TIPOPAGAMENTO', '1');
                        cData += XML.montaTag('VALOR', valorDaParcela);
                        //cData += XML.montaTag('DEBITOCREDITO', 'C');
                        cData += XML.montaTag('IDSEQPAGTO1', '-1');
                    cData += '</TMOVPAGTO>'
                }
                for (let i = 0; i < listaDeItens.length; i++) {
                    let codigoDaNatureza = (listaDeItens[i] as { codigoDaNatureza: string }).codigoDaNatureza;
                    let codigoDoItem = (listaDeItens[i] as { codigoDoItem: string }).codigoDoItem;
                    let qtdDoItem = (listaDeItens[i] as { qtdDoItem: string }).qtdDoItem;
                    let valorDoItem = (listaDeItens[i] as { valorDoItem: string }).valorDoItem;
                    let totalDoItem = (listaDeItens[i] as { totalDoItem: string }).totalDoItem;
            
                    cData += '<TITMMOV>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('CODFILIAL', CODFILIAL);
                        cData += XML.montaTag('NUMEROSEQUENCIAL', (i + 1).toString());
                        cData += XML.montaTag('IDPRD', codigoDoItem);
                        cData += XML.montaTag('QUANTIDADE', qtdDoItem);
                        cData += XML.montaTag('PRECOUNITARIO', valorDoItem); // PRECO UNITARIO
                        cData += XML.montaTag('PRECOTABELA', '0.0000');
                        cData += XML.montaTag('DATAEMISSAO', DATE.getDateTime());
                        cData += XML.montaTag('CODUND', 'UN');
                        cData += XML.montaTag('QUANTIDADEARECEBER', qtdDoItem);
                        cData += XML.montaTag('VALORUNITARIO', '0.0000');
                        cData += XML.montaTag('VALORFINANCEIRO', '0.0000');
                        cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                        cData += XML.montaTag('ALIQORDENACAO', '0.0000');
                        cData += XML.montaTag('QUANTIDADEORIGINAL', qtdDoItem);
                        cData += XML.montaTag('FLAG', '0');
                        cData += XML.montaTag('FATORCONVUND', '0.0000');
                        cData += XML.montaTag('VALORBRUTOITEM', '0.0000'); 
                        cData += XML.montaTag('ITEM', totalDoItem);// PRECO UNITARIO X QTD
                        cData += XML.montaTag('QUANTIDADESEPARADA', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('COMISSAOREPRES', '0.0000');
                        cData += XML.montaTag('VALORESCRITURACAO', '0.0000');
                        cData += XML.montaTag('VALORFINPEDIDO', '0.0000');
                        cData += XML.montaTag('VALOROPFRM1', '0.0000');
                        cData += XML.montaTag('VALOROPFRM2', '0.0000');
                        cData += XML.montaTag('PRECOEDITADO', '0');
                        cData += XML.montaTag('QTDEVOLUMEUNITARIO', qtdDoItem);
                        cData += XML.montaTag('CODVEN1', campos.codigoDoComprador);
                        cData += XML.montaTag('PRECOTOTALEDITADO', '0');
                        cData += XML.montaTag('VALORDESCCONDICONALITM', '0.0000');
                        cData += XML.montaTag('VALORDESPCONDICIONALITM', '0.0000');
                        cData += XML.montaTag('CODTBORCAMENTO', codigoDaNatureza);
                        cData += XML.montaTag('CODCOLTBORCAMENTO', '0');
                        cData += XML.montaTag('VALORUNTORCAMENTO', '0.0000');
                        cData += XML.montaTag('VALSERVICONFE', '0.0000');
                        cData += XML.montaTag('CODLOC', ESTOQUE);
                        cData += XML.montaTag('VALORBEM', '0.0000');
                        cData += XML.montaTag('VALORLIQUIDO', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('RATEIOCCUSTODEPTO', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('VALORBRUTOITEMORIG', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('QUANTIDADETOTAL', '0.0000');
                        cData += XML.montaTag('PRODUTOSUBSTITUTO', '0');
                        cData += XML.montaTag('PRECOUNITARIOSELEC', '0');
                        cData += XML.montaTag('QUANTIDADECONCLUIDA', qtdDoItem);
                        cData += XML.montaTag('INTEGRAAPLICACAO', "T");
                        cData += XML.montaTag('VALORBASEDEPRECIACAOBEM', '0');
                        cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA);
                        cData += XML.montaTag('IDMOVHST', '-1');
                        cData += XML.montaTag('NSEQITMMOV1', (i + 1).toString());
                    cData += '</TITMMOV>'
                    cData += '<TITMMOVRATCCU>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                        cData += XML.montaTag('VALOR', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('IDMOVRATCCU', '-1');
                    cData += '</TITMMOVRATCCU>'
                    cData += '<TITMMOVCOMPL>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                    cData += '</TITMMOVCOMPL>'
                    // if(OC !== '' || AD !== ''){
                    //     cData += '<TITMMOVRELAC>'
                    //         cData += XML.montaTag('IDMOVORIGEM', OC);
                    //         cData += XML.montaTag('NSEQITMMOVORIGEM', (i + 1).toString());
                    //         cData += XML.montaTag('CODCOLORIGEM', CODCOLIGADA);
                    //         cData += XML.montaTag('IDMOVDESTINO', '-1');
                    //         cData += XML.montaTag('NSEQITMMOVDESTINO', (i + 1).toString());
                    //         cData += XML.montaTag('CODCOLDESTINO', CODCOLIGADA);
                    //         cData += XML.montaTag('QUANTIDADE', qtdDoItem);
                    //     cData += '</TITMMOVRELAC>'
                    // }
                    // for (let j = 0; j < tributos.length; j++) {
                    //     cData += '<TTRBITMMOV>';
                    //         cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA); 
                    //         cData += XML.montaTag('IDMOV', '-1');  
                    //         cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());   
                    //         cData += XML.montaTag('CODTRB', tributos[j]);
                    //         cData += XML.montaTag('BASEDECALCULO', totalDoItem);
                    //         cData += XML.montaTag('VALOR', '0.0000');    
                    //         cData += XML.montaTag('FATORREDUCAO', '0.0000');
                    //         cData += XML.montaTag('FATORSUBSTTRIB', '0.0000');
                    //         cData += XML.montaTag('BASEDECALCULOCALCULADA', totalDoItem);
                    //         cData += XML.montaTag('EDITADO', '0');
                    //         cData += XML.montaTag('PERCDIFERIMENTOPARCIALICMS', '0.0000');
                    //         cData += XML.montaTag('BASECHEIA', '0.0000');
                    //     cData += '</TTRBITMMOV>';
                    // }
                    cData += '<TITMMOVFISCAL>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('QTDECONTRATADA', '0.0000');
                        cData += XML.montaTag('VLRTOTTRIB', '0.0000');
                        cData += XML.montaTag('AQUISICAOPAA', '0');
                        cData += XML.montaTag('POEBTRIBUTAVEL', '1');
                    cData += '</TITMMOVFISCAL>';
                }
                cData += '<TMOVCOMPL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('MULTIPLO', 'N');
                    cData += XML.montaTag('TICKET', campos.ticketRaiz);
                    cData += XML.montaTag('LINKDOCUMENTO', (campos.anexarNotaFiscal).slice(0, 255));
                    cData += XML.montaTag('REMETENTE', campos.remetente);
                    cData += XML.montaTag('INICIOPRESTACAO', campos.inicioDaPrestacao);
                    cData += XML.montaTag('DESTINATARIO', campos.destinatario);
                    cData += XML.montaTag('TERMINOPRESTACAO', campos.terminoDaPrestacao);
                cData += '</TMOVCOMPL>'
                cData += '<TMOVTRANSP>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('RETIRAMERCADORIA', '0')
                    cData += XML.montaTag('TIPOCTE', '0')
                    cData += XML.montaTag('TOMADORTIPO', '0')
                    cData += XML.montaTag('TIPOEMITENTEMDFE', '0')
                    cData += XML.montaTag('LOTACAO', '1')
                    cData += XML.montaTag('TIPOTRANSPORTADORMDFE', '0')
                    cData += XML.montaTag('TIPOBPE', '0')
                cData += '</TMOVTRANSP>'
            cData += '</MovMovimento>'
        cData += ']]>';

        return cData;

    } catch (error) {
        console.log(error);
        throw error; 
    }

}

export function xmlMovCC(campos: any, CODCOLIGADA: string, CODFILIAL: string, SERIE: string, CODTMV: string, ESTOQUE: string, HISTORICOCURTO: string) {
    try {
        var idPrd = ''
        var codigoDaNatureza = ''

        if (CODTMV == '1.2.09'){
            idPrd = '17' 
            codigoDaNatureza = '02.07.00048' 
        } else if (CODTMV == '1.2.10'){
            idPrd = '7575' 
            codigoDaNatureza = '02.07.00047' 
        } else if (CODTMV == '1.2.11'){
            idPrd = '5251' 
            codigoDaNatureza = '02.07.00051' 
        } else if (CODTMV == '1.2.12'){
            idPrd = '5563' 
            codigoDaNatureza = '02.07.00055'             
        }

        //let listaDeItens = campos.itens as object[];
    
        var cData = '';
        cData += '<![CDATA['
            cData += '<MovMovimento>'
                cData += '<TMOV>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODFILIAL', CODFILIAL)
                    cData += XML.montaTag('CODLOC', ESTOQUE)
                    cData += XML.montaTag('CODLOCDESTINO', ESTOQUE)
                    cData += XML.montaTag('CODCFO', campos.codigoDoFornecedor)
                    cData += XML.montaTag('NUMEROMOV', (campos.numeroDaNF).slice(0, 9))
                    cData += XML.montaTag('SERIE', '1')
                    cData += XML.montaTag('CODTMV', CODTMV)
                    cData += XML.montaTag('TIPO', 'A')
                    cData += XML.montaTag('MOVIMPRESSO', '0')
                    cData += XML.montaTag('DOCIMPRESSO', '0')
                    cData += XML.montaTag('FATIMPRESSA', '0')
                    cData += XML.montaTag('DATAEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('COMISSAOREPRES', '0.0000')
                    cData += XML.montaTag('CODCPG', '001')
                    cData += XML.montaTag('VALORBRUTO', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDO', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROS', campos.valorTotal)
                    cData += XML.montaTag('PERCENTUALFRETE', '0.0000')
                    cData += XML.montaTag('VALORFRETE', '0.0000')
                    cData += XML.montaTag('PERCENTUALDESC', '0.0000')
                    cData += XML.montaTag('VALORDESC', '0.0000')
                    cData += XML.montaTag('PERCENTUALDESP', '0.0000')
                    cData += XML.montaTag('VALORDESP', '0.0000')
                    cData += XML.montaTag('PERCCOMISSAO', '0.0000')
                    cData += XML.montaTag('CODMEN', '01')
                    cData += XML.montaTag('PESOLIQUIDO', '0.0000')
                    cData += XML.montaTag('PESOBRUTO', '0.0000')
                    cData += XML.montaTag('IDMOVLCTFLUXUS', '-1')
                    cData += XML.montaTag('CODMOEVALORLIQUIDO', 'R$')
                    cData += XML.montaTag('DATAMOVIMENTO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('GEROUFATURA', '0')
                    cData += XML.montaTag('NUMEROLCTABERTO', '1')
                    cData += XML.montaTag('CODCFOAUX', campos.codigoDoFornecedor)
                    cData += XML.montaTag('VALORRECEBIDO', campos.valorTotal)
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('CODVEN1', campos.codigoDoComprador)
                    cData += XML.montaTag('PERCCOMISSAOVEN2', '0.0000')
                    cData += XML.montaTag('CODCOLCFO', '0')
                    cData += XML.montaTag('CODUSUARIO', 'p_heflo')
                    cData += XML.montaTag('CODFILIALDESTINO', CODFILIAL)
                    cData += XML.montaTag('GERADOPORLOTE', '0')
                    cData += XML.montaTag('STATUSEXPORTCONT', '0')
                    cData += XML.montaTag('GEROUCONTATRABALHO', '0')
                    cData += XML.montaTag('GERADOPORCONTATRABALHO', '0')
                    cData += XML.montaTag('HORULTIMAALTERACAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('INDUSOOBJ', '0.00')
                    cData += XML.montaTag('INTEGRADOBONUM', '0')
                    cData += XML.montaTag('FLAGPROCESSADO', '0')
                    cData += XML.montaTag('ABATIMENTOICMS', '0.0000')
                    cData += XML.montaTag('HORARIOEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('USUARIOCRIACAO', 'p_heflo')
                    cData += XML.montaTag('STSEMAIL', '0.0000')
                    cData += XML.montaTag('VALORBRUTOINTERNO', campos.valorTotal)
                    cData += XML.montaTag('VINCULADOESTOQUEFL', '0.0000')
                    cData += XML.montaTag('VRBASEINSSOUTRAEMPRESA', '0.0000')
                    cData += XML.montaTag('VALORDESCCONDICIONAL', '0.0000')
                    cData += XML.montaTag('VALORDESPCONDICIONAL', '0.0000')
                    cData += XML.montaTag('INTEGRADOAUTOMACAO', '0.0000')
                    cData += XML.montaTag('INTEGRAAPLICACAO', 'T')
                    cData += XML.montaTag('DATALANCAMENTO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('RECIBONFESTATUS', '0')
                    cData += XML.montaTag('VALORMERCADORIAS', '0.0000')
                    cData += XML.montaTag('USARATEIOVALORFIN', '1')
                    cData += XML.montaTag('CODCOLCFOAUX', '0')
                    cData += XML.montaTag('VALORRATEIOLAN', campos.valorTotal)
                    cData += XML.montaTag('RATEIOCCUSTODEPTO', campos.valorTotal)
                    cData += XML.montaTag('VALORBRUTOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROSORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORRATEIOLANORIG', campos.valorTotal)
                    cData += XML.montaTag('HISTORICOCURTO', HISTORICOCURTO)
                    cData += XML.montaTag('FLAGCONCLUSAO', '0')
                    cData += XML.montaTag('STATUSPARADIGMA', 'N')
                    cData += XML.montaTag('STATUSINTEGRACAO', 'N')
                    cData += XML.montaTag('PERCCOMISSAOVEN3', '0.0000')
                    cData += XML.montaTag('PERCCOMISSAOVEN4', '0.0000')
                    cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA)
                    cData += XML.montaTag('IDMOVHST', '-1')
                cData += '</TMOV>'
                cData += '<TNFE>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('VALORSERVICO', '0.0000')
                    cData += XML.montaTag('DEDUCAOSERVICO', '0.0000')
                    cData += XML.montaTag('ALIQUOTAISS', '0.0000')
                    cData += XML.montaTag('ISSRETIDO', '0')
                    cData += XML.montaTag('VALORISS', '0.0000')
                    cData += XML.montaTag('VALORCREDITOIPTU', '0.0000')
                    cData += XML.montaTag('BASEDECALCULO', '0.0000')
                    cData += XML.montaTag('EDITADO', '0')
                cData += '</TNFE>'
                cData += '<TMOVFISCAL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CONTRIBUINTECREDENCIADO', '0')
                    cData += XML.montaTag('OPERACAOCONSUMIDORFINAL', '0')
                    cData += XML.montaTag('OPERACAOPRESENCIAL', '0')
                cData += '</TMOVFISCAL>'
                cData += '<TMOVRATCCU>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('VALOR', campos.valorTotal)
                    cData += XML.montaTag('IDMOVRATCCU', '-1')
                cData += '</TMOVRATCCU>'
                // cData += '<TMOVPAGTO>'
                //     cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                //     cData += XML.montaTag('IDSEQPAGTO', '-1');
                //     cData += XML.montaTag('IDMOV', '-1');
                //     cData += XML.montaTag('TAXAADM', '0.0000');
                //     cData += XML.montaTag('IDLAN', '-1');
                //     cData += XML.montaTag('DATAVENCIMENTO', DATE.getDateTime());
                //     cData += XML.montaTag('TIPOPAGAMENTO', '1');
                //     cData += XML.montaTag('VALOR', campos.valorTotal);
                //     cData += XML.montaTag('DEBITOCREDITO', 'C');
                //     cData += XML.montaTag('IDSEQPAGTO1', '-1');
                // cData += '</TMOVPAGTO>'
                cData += '<TITMMOV>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('NSEQITMMOV', '1');
                    cData += XML.montaTag('CODFILIAL', CODFILIAL);
                    cData += XML.montaTag('NUMEROSEQUENCIAL', '1');
                    cData += XML.montaTag('IDPRD', idPrd);
                    cData += XML.montaTag('QUANTIDADE', '1');
                    cData += XML.montaTag('PRECOUNITARIO', campos.valorTotal); // PRECO UNITARIO
                    cData += XML.montaTag('PRECOTABELA', '0.0000');
                    cData += XML.montaTag('DATAEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao));
                    cData += XML.montaTag('CODUND', 'UN');
                    cData += XML.montaTag('QUANTIDADEARECEBER', '1');
                    cData += XML.montaTag('VALORUNITARIO', '0.0000');
                    cData += XML.montaTag('VALORFINANCEIRO', '0.0000');
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                    cData += XML.montaTag('ALIQORDENACAO', '0.0000');
                    cData += XML.montaTag('QUANTIDADEORIGINAL', '1');
                    cData += XML.montaTag('FLAG', '0');
                    cData += XML.montaTag('FATORCONVUND', '0.0000');
                    cData += XML.montaTag('VALORBRUTOITEM', '0.0000'); 
                    cData += XML.montaTag('ITEM', campos.valorTotal);// PRECO UNITARIO X QTD
                    cData += XML.montaTag('QUANTIDADESEPARADA', campos.valorTotal); // PRECO UNITARIO X QTD
                    cData += XML.montaTag('COMISSAOREPRES', '0.0000');
                    cData += XML.montaTag('VALORESCRITURACAO', '0.0000');
                    cData += XML.montaTag('VALORFINPEDIDO', '0.0000');
                    cData += XML.montaTag('VALOROPFRM1', '0.0000');
                    cData += XML.montaTag('VALOROPFRM2', '0.0000');
                    cData += XML.montaTag('PRECOEDITADO', '0');
                    cData += XML.montaTag('QTDEVOLUMEUNITARIO', '1');
                    cData += XML.montaTag('CODVEN1', campos.codigoDoComprador);
                    cData += XML.montaTag('PRECOTOTALEDITADO', '0');
                    cData += XML.montaTag('VALORDESCCONDICONALITM', '0.0000');
                    cData += XML.montaTag('VALORDESPCONDICIONALITM', '0.0000');
                    cData += XML.montaTag('CODTBORCAMENTO', codigoDaNatureza);
                    cData += XML.montaTag('CODCOLTBORCAMENTO', '0');
                    cData += XML.montaTag('VALORUNTORCAMENTO', '0.0000');
                    cData += XML.montaTag('VALSERVICONFE', '0.0000');
                    cData += XML.montaTag('CODLOC', ESTOQUE);
                    cData += XML.montaTag('VALORBEM', '0.0000');
                    cData += XML.montaTag('VALORLIQUIDO', campos.valorTotal); // PRECO UNITARIO X QTD
                    cData += XML.montaTag('RATEIOCCUSTODEPTO', campos.valorTotal); // PRECO UNITARIO X QTD
                    cData += XML.montaTag('VALORBRUTOITEMORIG', campos.valorTotal); // PRECO UNITARIO X QTD
                    cData += XML.montaTag('QUANTIDADETOTAL', '0.0000');
                    cData += XML.montaTag('PRODUTOSUBSTITUTO', '0');
                    cData += XML.montaTag('PRECOUNITARIOSELEC', '0');
                    cData += XML.montaTag('QUANTIDADECONCLUIDA', '1');
                    cData += XML.montaTag('INTEGRAAPLICACAO', "T");
                    cData += XML.montaTag('VALORBASEDEPRECIACAOBEM', '0');
                    cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA);
                    cData += XML.montaTag('IDMOVHST', '-1');
                    cData += XML.montaTag('NSEQITMMOV1', '1');
                cData += '</TITMMOV>'
                cData += '<TITMMOVRATCCU>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('NSEQITMMOV', '1');
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                    cData += XML.montaTag('VALOR', campos.valorTotal); // PRECO UNITARIO X QTD
                    cData += XML.montaTag('IDMOVRATCCU', '-1');
                cData += '</TITMMOVRATCCU>'
                // cData += '<TMOVPAGTO>'
                //     cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                //     cData += XML.montaTag('IDSEQPAGTO', '-1');
                //     cData += XML.montaTag('IDMOV', '-1');
                //     cData += XML.montaTag('CODCOLCFODEFAULT', '0');
                //     cData += XML.montaTag('TIPOFORMAPAGTO', '3');
                //     cData += XML.montaTag('TAXAADM', '0.0000');
                //     cData += XML.montaTag('CODCXA', '003');
                //     cData += XML.montaTag('CODCOLCXA', '0');
                //     cData += XML.montaTag('IDLAN', '-1');
                //     cData += XML.montaTag('IDFORMAPAGTO', '2');
                //     cData += XML.montaTag('DATAVENCIMENTO', DATE.getDateTime());
                //     cData += XML.montaTag('TIPOPAGAMENTO', '1');
                //     cData += XML.montaTag('VALOR', campos.valorTotal);
                //     cData += XML.montaTag('DEBITOCREDITO', 'C');
                //     cData += XML.montaTag('IDSEQPAGTO1', '-1');
                //  cData += '</TMOVPAGTO>'
                cData += '<TITMMOVCOMPL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('NSEQITMMOV', '1');
                cData += '</TITMMOVCOMPL>'
                // if(OC !== '' || AD !== ''){
                //     cData += '<TITMMOVRELAC>'
                //         cData += XML.montaTag('IDMOVORIGEM', OC);
                //         cData += XML.montaTag('NSEQITMMOVORIGEM', (i + 1).toString());
                //         cData += XML.montaTag('CODCOLORIGEM', CODCOLIGADA);
                //         cData += XML.montaTag('IDMOVDESTINO', '-1');
                //         cData += XML.montaTag('NSEQITMMOVDESTINO', (i + 1).toString());
                //         cData += XML.montaTag('CODCOLDESTINO', CODCOLIGADA);
                //         cData += XML.montaTag('QUANTIDADE', '1');
                //     cData += '</TITMMOVRELAC>'
                // }
                // for (let j = 0; j < tributos.length; j++) {
                //     cData += '<TTRBITMMOV>';
                //         cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA); 
                //         cData += XML.montaTag('IDMOV', '-1');  
                //         cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());   
                //         cData += XML.montaTag('CODTRB', tributos[j]);
                //         cData += XML.montaTag('BASEDECALCULO', totalDoItem);
                //         cData += XML.montaTag('VALOR', '0.0000');    
                //         cData += XML.montaTag('FATORREDUCAO', '0.0000');
                //         cData += XML.montaTag('FATORSUBSTTRIB', '0.0000');
                //         cData += XML.montaTag('BASEDECALCULOCALCULADA', totalDoItem);
                //         cData += XML.montaTag('EDITADO', '0');
                //         cData += XML.montaTag('PERCDIFERIMENTOPARCIALICMS', '0.0000');
                //         cData += XML.montaTag('BASECHEIA', '0.0000');
                //     cData += '</TTRBITMMOV>';
                // }
                cData += '<TITMMOVFISCAL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('NSEQITMMOV', '1');
                    cData += XML.montaTag('QTDECONTRATADA', '0.0000');
                    cData += XML.montaTag('VLRTOTTRIB', '0.0000');
                    cData += XML.montaTag('AQUISICAOPAA', '0');
                    cData += XML.montaTag('POEBTRIBUTAVEL', '1');
                cData += '</TITMMOVFISCAL>';
                cData += '<TMOVCOMPL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('MULTIPLO', 'N');
                    cData += XML.montaTag('TICKET', campos.ticketRaiz);
                    cData += XML.montaTag('LINKDOCUMENTO', (campos.anexarNotaFiscal).slice(0, 255));
                    cData += XML.montaTag('REMETENTE', campos.remetente);
                    cData += XML.montaTag('INICIOPRESTACAO', campos.inicioDaPrestacao);
                    cData += XML.montaTag('DESTINATARIO', campos.destinatario);
                    cData += XML.montaTag('TERMINOPRESTACAO', campos.terminoDaPrestacao);
                cData += '</TMOVCOMPL>'
                cData += '<TMOVTRANSP>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('RETIRAMERCADORIA', '0')
                    cData += XML.montaTag('TIPOCTE', '0')
                    cData += XML.montaTag('TOMADORTIPO', '0')
                    cData += XML.montaTag('TIPOEMITENTEMDFE', '0')
                    cData += XML.montaTag('LOTACAO', '1')
                    cData += XML.montaTag('TIPOTRANSPORTADORMDFE', '0')
                    cData += XML.montaTag('TIPOBPE', '0')
                cData += '</TMOVTRANSP>'
            cData += '</MovMovimento>'
        cData += ']]>';

        return cData;

    } catch (error) {
        console.log(error);
        throw error; 
    }

}

export function xmlMovAPJ(campos: any, CODCOLIGADA: string, CODFILIAL: string, SERIE: string, CODTMV: string, ESTOQUE: string, HISTORICOCURTO: string) {
    try {
        var listaDeItens = [{
            codigoDaNatureza: '02.09.00001',
            codigoDoItem:'113849',
            qtdDoItem:'1',
            valorDoItem: campos.valorTotal,
            totalDoItem: campos.valorTotal
        }];

        if(campos.valorDoIPTU != "" && campos.valorDoIPTU!= "0,00"){
            listaDeItens.push({
                codigoDaNatureza: '02.09.00001',
                codigoDoItem: '11',
                qtdDoItem: '1',
                valorDoItem: campos.valorDoIPTU,
                totalDoItem: campos.valorDoIPTU
            })
        }
        if(campos.valorDoCondominio != "" && campos.valorDoCondominio!= "0,00"){
            listaDeItens.push({
                codigoDaNatureza: '02.09.00001',
                codigoDoItem:'5659',
                qtdDoItem:'1',
                valorDoItem: campos.valorDoCondominio,
                totalDoItem: campos.valorDoCondominio
            })
        }
        if(campos.valorTaxaDeIncendio != "" && campos.valorTaxaDeIncendio!= "0,00"){
            listaDeItens.push({
                codigoDaNatureza: '02.09.00001',
                codigoDoItem:'5709',
                qtdDoItem:'1',
                valorDoItem: campos.valorTaxaDeIncendio,
                totalDoItem: campos.valorTaxaDeIncendio
            })
        }
    
        var cData = '';
        cData += '<![CDATA['
            cData += '<MovMovimento>'
                cData += '<TMOV>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODFILIAL', CODFILIAL)
                    cData += XML.montaTag('CODLOC', ESTOQUE)
                    cData += XML.montaTag('CODLOCDESTINO', ESTOQUE)
                    cData += XML.montaTag('CODCFO', campos.codigoDoFornecedor)
                    cData += XML.montaTag('NUMEROMOV', (campos.numeroDaNF).slice(0, 9))
                    cData += XML.montaTag('SERIE', 'ALPJ')
                    cData += XML.montaTag('CODTMV', CODTMV)
                    cData += XML.montaTag('TIPO', 'A')
                    cData += XML.montaTag('MOVIMPRESSO', '0')
                    cData += XML.montaTag('DOCIMPRESSO', '0')
                    cData += XML.montaTag('FATIMPRESSA', '0')
                    cData += XML.montaTag('DATAEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('COMISSAOREPRES', '0.0000')
                    cData += XML.montaTag('CODCPG', '001')
                    cData += XML.montaTag('VALORBRUTO', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDO', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROS', campos.valorTotal)
                    cData += XML.montaTag('PERCENTUALFRETE', '0.0000')
                    cData += XML.montaTag('VALORFRETE', '0.0000')
                    cData += XML.montaTag('PERCENTUALDESC', '0.0000')
                    cData += XML.montaTag('VALORDESC', '0.0000')
                    cData += XML.montaTag('PERCENTUALDESP', '0.0000')
                    cData += XML.montaTag('VALORDESP', '0.0000')
                    cData += XML.montaTag('PERCCOMISSAO', '0.0000')
                    cData += XML.montaTag('CODMEN', '01')
                    cData += XML.montaTag('PESOLIQUIDO', '0.0000')
                    cData += XML.montaTag('PESOBRUTO', '0.0000')
                    cData += XML.montaTag('IDMOVLCTFLUXUS', '-1')
                    cData += XML.montaTag('CODMOEVALORLIQUIDO', 'R$')
                    cData += XML.montaTag('DATAMOVIMENTO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('GEROUFATURA', '0')
                    cData += XML.montaTag('NUMEROLCTABERTO', '1')
                    cData += XML.montaTag('CODCFOAUX', campos.codigoDoFornecedor)
                    cData += XML.montaTag('VALORRECEBIDO', campos.valorTotal)
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('CODVEN1', campos.codigoDoComprador)
                    cData += XML.montaTag('PERCCOMISSAOVEN2', '0.0000')
                    cData += XML.montaTag('CODCOLCFO', '0')
                    cData += XML.montaTag('CODUSUARIO', 'p_heflo')
                    cData += XML.montaTag('CODFILIALDESTINO', CODFILIAL)
                    cData += XML.montaTag('GERADOPORLOTE', '0')
                    cData += XML.montaTag('STATUSEXPORTCONT', '0')
                    cData += XML.montaTag('GEROUCONTATRABALHO', '0')
                    cData += XML.montaTag('GERADOPORCONTATRABALHO', '0')
                    cData += XML.montaTag('HORULTIMAALTERACAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('INDUSOOBJ', '0.00')
                    cData += XML.montaTag('INTEGRADOBONUM', '0')
                    cData += XML.montaTag('FLAGPROCESSADO', '0')
                    cData += XML.montaTag('ABATIMENTOICMS', '0.0000')
                    cData += XML.montaTag('HORARIOEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('USUARIOCRIACAO', 'p_heflo')
                    cData += XML.montaTag('STSEMAIL', '0.0000')
                    cData += XML.montaTag('VALORBRUTOINTERNO', campos.valorTotal)
                    cData += XML.montaTag('VINCULADOESTOQUEFL', '0.0000')
                    cData += XML.montaTag('VRBASEINSSOUTRAEMPRESA', '0.0000')
                    cData += XML.montaTag('VALORDESCCONDICIONAL', '0.0000')
                    cData += XML.montaTag('VALORDESPCONDICIONAL', '0.0000')
                    cData += XML.montaTag('INTEGRADOAUTOMACAO', '0.0000')
                    cData += XML.montaTag('INTEGRAAPLICACAO', 'T')
                    cData += XML.montaTag('DATALANCAMENTO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('RECIBONFESTATUS', '0')
                    cData += XML.montaTag('VALORMERCADORIAS', '0.0000')
                    cData += XML.montaTag('USARATEIOVALORFIN', '1')
                    cData += XML.montaTag('CODCOLCFOAUX', '0')
                    cData += XML.montaTag('VALORRATEIOLAN', campos.valorTotal)
                    cData += XML.montaTag('RATEIOCCUSTODEPTO', campos.valorTotal)
                    cData += XML.montaTag('VALORBRUTOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROSORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORRATEIOLANORIG', campos.valorTotal)
                    cData += XML.montaTag('HISTORICOCURTO', HISTORICOCURTO)
                    cData += XML.montaTag('FLAGCONCLUSAO', '0')
                    cData += XML.montaTag('STATUSPARADIGMA', 'N')
                    cData += XML.montaTag('STATUSINTEGRACAO', 'N')
                    cData += XML.montaTag('PERCCOMISSAOVEN3', '0.0000')
                    cData += XML.montaTag('PERCCOMISSAOVEN4', '0.0000')
                    cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA)
                    cData += XML.montaTag('IDMOVHST', '-1')
                cData += '</TMOV>'
                cData += '<TNFE>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('VALORSERVICO', '0.0000')
                    cData += XML.montaTag('DEDUCAOSERVICO', '0.0000')
                    cData += XML.montaTag('ALIQUOTAISS', '0.0000')
                    cData += XML.montaTag('ISSRETIDO', '0')
                    cData += XML.montaTag('VALORISS', '0.0000')
                    cData += XML.montaTag('VALORCREDITOIPTU', '0.0000')
                    cData += XML.montaTag('BASEDECALCULO', '0.0000')
                    cData += XML.montaTag('EDITADO', '0')
                cData += '</TNFE>'
                cData += '<TMOVFISCAL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CONTRIBUINTECREDENCIADO', '0')
                    cData += XML.montaTag('OPERACAOCONSUMIDORFINAL', '0')
                    cData += XML.montaTag('OPERACAOPRESENCIAL', '0')
                cData += '</TMOVFISCAL>'
                cData += '<TMOVRATCCU>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('VALOR', campos.valorTotal)
                    cData += XML.montaTag('IDMOVRATCCU', '-1')
                cData += '</TMOVRATCCU>'
                // cData += '<TMOVPAGTO>'
                //     cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                //     cData += XML.montaTag('IDSEQPAGTO', '-1');
                //     cData += XML.montaTag('IDMOV', '-1');
                //     cData += XML.montaTag('TAXAADM', '0.0000');
                //     cData += XML.montaTag('IDLAN', '-1');
                //     cData += XML.montaTag('DATAVENCIMENTO', DATE.getDateTime());
                //     cData += XML.montaTag('TIPOPAGAMENTO', '1');
                //     cData += XML.montaTag('VALOR', campos.valorTotal);
                //     cData += XML.montaTag('DEBITOCREDITO', 'C');
                //     cData += XML.montaTag('IDSEQPAGTO1', '-1');
                // cData += '</TMOVPAGTO>'
                for (let i = 0; i < listaDeItens.length; i++) {
                    let codigoDaNatureza = (listaDeItens[i] as { codigoDaNatureza: string }).codigoDaNatureza;
                    let codigoDoItem = (listaDeItens[i] as { codigoDoItem: string }).codigoDoItem;
                    let qtdDoItem = (listaDeItens[i] as { qtdDoItem: string }).qtdDoItem;
                    let valorDoItem = (listaDeItens[i] as { valorDoItem: string }).valorDoItem;
                    let totalDoItem = (listaDeItens[i] as { totalDoItem: string }).totalDoItem;
            
                    cData += '<TITMMOV>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('CODFILIAL', CODFILIAL);
                        cData += XML.montaTag('NUMEROSEQUENCIAL', (i + 1).toString());
                        cData += XML.montaTag('IDPRD', codigoDoItem);
                        cData += XML.montaTag('QUANTIDADE', qtdDoItem);
                        cData += XML.montaTag('PRECOUNITARIO', valorDoItem); // PRECO UNITARIO
                        cData += XML.montaTag('PRECOTABELA', '0.0000');
                        cData += XML.montaTag('DATAEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao));
                        cData += XML.montaTag('CODUND', 'UN');
                        cData += XML.montaTag('QUANTIDADEARECEBER', qtdDoItem);
                        cData += XML.montaTag('VALORUNITARIO', '0.0000');
                        cData += XML.montaTag('VALORFINANCEIRO', '0.0000');
                        cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                        cData += XML.montaTag('ALIQORDENACAO', '0.0000');
                        cData += XML.montaTag('QUANTIDADEORIGINAL', qtdDoItem);
                        cData += XML.montaTag('FLAG', '0');
                        cData += XML.montaTag('FATORCONVUND', '0.0000');
                        cData += XML.montaTag('VALORBRUTOITEM', '0.0000'); 
                        cData += XML.montaTag('ITEM', totalDoItem);// PRECO UNITARIO X QTD
                        cData += XML.montaTag('QUANTIDADESEPARADA', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('COMISSAOREPRES', '0.0000');
                        cData += XML.montaTag('VALORESCRITURACAO', '0.0000');
                        cData += XML.montaTag('VALORFINPEDIDO', '0.0000');
                        cData += XML.montaTag('VALOROPFRM1', '0.0000');
                        cData += XML.montaTag('VALOROPFRM2', '0.0000');
                        cData += XML.montaTag('PRECOEDITADO', '0');
                        cData += XML.montaTag('QTDEVOLUMEUNITARIO', qtdDoItem);
                        cData += XML.montaTag('CODVEN1', campos.codigoDoComprador);
                        cData += XML.montaTag('PRECOTOTALEDITADO', '0');
                        cData += XML.montaTag('VALORDESCCONDICONALITM', '0.0000');
                        cData += XML.montaTag('VALORDESPCONDICIONALITM', '0.0000');
                        cData += XML.montaTag('CODTBORCAMENTO', codigoDaNatureza);
                        cData += XML.montaTag('CODCOLTBORCAMENTO', '0');
                        cData += XML.montaTag('VALORUNTORCAMENTO', '0.0000');
                        cData += XML.montaTag('VALSERVICONFE', '0.0000');
                        cData += XML.montaTag('CODLOC', ESTOQUE);
                        cData += XML.montaTag('VALORBEM', '0.0000');
                        cData += XML.montaTag('VALORLIQUIDO', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('RATEIOCCUSTODEPTO', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('VALORBRUTOITEMORIG', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('QUANTIDADETOTAL', '0.0000');
                        cData += XML.montaTag('PRODUTOSUBSTITUTO', '0');
                        cData += XML.montaTag('PRECOUNITARIOSELEC', '0');
                        cData += XML.montaTag('QUANTIDADECONCLUIDA', qtdDoItem);
                        cData += XML.montaTag('INTEGRAAPLICACAO', "T");
                        cData += XML.montaTag('VALORBASEDEPRECIACAOBEM', '0');
                        cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA);
                        cData += XML.montaTag('IDMOVHST', '-1');
                        cData += XML.montaTag('NSEQITMMOV1', (i + 1).toString());
                    cData += '</TITMMOV>'
                    cData += '<TITMMOVRATCCU>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                        cData += XML.montaTag('VALOR', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('IDMOVRATCCU', '-1');
                    cData += '</TITMMOVRATCCU>'
                    cData += '<TITMMOVCOMPL>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                    cData += '</TITMMOVCOMPL>'
                    // if(OC !== '' || AD !== ''){
                    //     cData += '<TITMMOVRELAC>'
                    //         cData += XML.montaTag('IDMOVORIGEM', OC);
                    //         cData += XML.montaTag('NSEQITMMOVORIGEM', (i + 1).toString());
                    //         cData += XML.montaTag('CODCOLORIGEM', CODCOLIGADA);
                    //         cData += XML.montaTag('IDMOVDESTINO', '-1');
                    //         cData += XML.montaTag('NSEQITMMOVDESTINO', (i + 1).toString());
                    //         cData += XML.montaTag('CODCOLDESTINO', CODCOLIGADA);
                    //         cData += XML.montaTag('QUANTIDADE', qtdDoItem);
                    //     cData += '</TITMMOVRELAC>'
                    // }
                    // for (let j = 0; j < tributos.length; j++) {
                    //     cData += '<TTRBITMMOV>';
                    //         cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA); 
                    //         cData += XML.montaTag('IDMOV', '-1');  
                    //         cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());   
                    //         cData += XML.montaTag('CODTRB', tributos[j]);
                    //         cData += XML.montaTag('BASEDECALCULO', totalDoItem);
                    //         cData += XML.montaTag('VALOR', '0.0000');    
                    //         cData += XML.montaTag('FATORREDUCAO', '0.0000');
                    //         cData += XML.montaTag('FATORSUBSTTRIB', '0.0000');
                    //         cData += XML.montaTag('BASEDECALCULOCALCULADA', totalDoItem);
                    //         cData += XML.montaTag('EDITADO', '0');
                    //         cData += XML.montaTag('PERCDIFERIMENTOPARCIALICMS', '0.0000');
                    //         cData += XML.montaTag('BASECHEIA', '0.0000');
                    //     cData += '</TTRBITMMOV>';
                    // }
                    cData += '<TITMMOVFISCAL>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('QTDECONTRATADA', '0.0000');
                        cData += XML.montaTag('VLRTOTTRIB', '0.0000');
                        cData += XML.montaTag('AQUISICAOPAA', '0');
                        cData += XML.montaTag('POEBTRIBUTAVEL', '1');
                    cData += '</TITMMOVFISCAL>';
                }
                cData += '<TMOVCOMPL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('MULTIPLO', 'N');
                    cData += XML.montaTag('TICKET', campos.ticketRaiz);
                    cData += XML.montaTag('LINKDOCUMENTO', (campos.anexarNotaFiscal).slice(0, 255));
                    cData += XML.montaTag('REMETENTE', campos.remetente);
                    cData += XML.montaTag('INICIOPRESTACAO', campos.inicioDaPrestacao);
                    cData += XML.montaTag('DESTINATARIO', campos.destinatario);
                    cData += XML.montaTag('TERMINOPRESTACAO', campos.terminoDaPrestacao);
                cData += '</TMOVCOMPL>'
                cData += '<TMOVTRANSP>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('RETIRAMERCADORIA', '0')
                    cData += XML.montaTag('TIPOCTE', '0')
                    cData += XML.montaTag('TOMADORTIPO', '0')
                    cData += XML.montaTag('TIPOEMITENTEMDFE', '0')
                    cData += XML.montaTag('LOTACAO', '1')
                    cData += XML.montaTag('TIPOTRANSPORTADORMDFE', '0')
                    cData += XML.montaTag('TIPOBPE', '0')
                cData += '</TMOVTRANSP>'
            cData += '</MovMovimento>'

        cData += ']]>';

        return cData;

    } catch (error) {
        console.log(error);
        throw error; 
    }

}

export function xmlMovAPF(campos: any, CODCOLIGADA: string, CODFILIAL: string, SERIE: string, CODTMV: string, ESTOQUE: string, HISTORICOCURTO: string) {
    try {
        var listaDeItens = [{
            codigoDaNatureza: '02.09.00001',
            codigoDoItem:'113849',
            qtdDoItem:'1',
            valorDoItem: campos.valorTotal,
            totalDoItem: campos.valorTotal
        }];

        if(campos.valorDoIPTU != ""){
            listaDeItens.push({
                codigoDaNatureza: '02.09.00001',
                codigoDoItem: '11',
                qtdDoItem: '1',
                valorDoItem: campos.valorDoIPTU,
                totalDoItem: campos.valorDoIPTU
            })
        }
        if(campos.valorDoCondominio != ""){
            listaDeItens.push({
                codigoDaNatureza: '02.09.00001',
                codigoDoItem:'5659',
                qtdDoItem:'1',
                valorDoItem: campos.valorDoCondominio,
                totalDoItem: campos.valorDoCondominio
            })
        }
        if(campos.valorTaxaDeIncendio != ""){
            listaDeItens.push({
                codigoDaNatureza: '02.09.00001',
                codigoDoItem:'5709',
                qtdDoItem:'1',
                valorDoItem: campos.valorTaxaDeIncendio,
                totalDoItem: campos.valorTaxaDeIncendio
            })
        }
    
        var cData = '';
        cData += '<![CDATA['
            cData += '<MovMovimento>'
                cData += '<TMOV>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODFILIAL', CODFILIAL)
                    cData += XML.montaTag('CODLOC', ESTOQUE)
                    cData += XML.montaTag('CODLOCDESTINO', ESTOQUE)
                    cData += XML.montaTag('CODCFO', campos.codigoDoFornecedor)
                    cData += XML.montaTag('NUMEROMOV', '-1')
                    cData += XML.montaTag('SERIE', 'AL')
                    cData += XML.montaTag('CODTMV', CODTMV)
                    cData += XML.montaTag('TIPO', 'A')
                    cData += XML.montaTag('MOVIMPRESSO', '0')
                    cData += XML.montaTag('DOCIMPRESSO', '0')
                    cData += XML.montaTag('FATIMPRESSA', '0')
                    cData += XML.montaTag('DATAEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('COMISSAOREPRES', '0.0000')
                    cData += XML.montaTag('CODCPG', campos.codigoDaFormaPagamento)
                    cData += XML.montaTag('VALORBRUTO', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDO', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROS', campos.valorTotal)
                    cData += XML.montaTag('PERCENTUALFRETE', '0.0000')
                    cData += XML.montaTag('VALORFRETE', '0.0000')
                    cData += XML.montaTag('PERCENTUALDESC', '0.0000')
                    cData += XML.montaTag('VALORDESC', '0.0000')
                    cData += XML.montaTag('PERCENTUALDESP', '0.0000')
                    cData += XML.montaTag('VALORDESP', '0.0000')
                    cData += XML.montaTag('PERCCOMISSAO', '0.0000')
                    cData += XML.montaTag('CODMEN', '01')
                    cData += XML.montaTag('PESOLIQUIDO', '0.0000')
                    cData += XML.montaTag('PESOBRUTO', '0.0000')
                    cData += XML.montaTag('IDMOVLCTFLUXUS', '-1')
                    cData += XML.montaTag('CODMOEVALORLIQUIDO', 'R$')
                    cData += XML.montaTag('DATAMOVIMENTO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('GEROUFATURA', '0')
                    cData += XML.montaTag('NUMEROLCTABERTO', '1')
                    cData += XML.montaTag('CODCFOAUX', campos.codigoDoFornecedor)
                    cData += XML.montaTag('VALORRECEBIDO', campos.valorTotal)
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('CODVEN1', campos.codigoDoComprador)
                    cData += XML.montaTag('PERCCOMISSAOVEN2', '0.0000')
                    cData += XML.montaTag('CODCOLCFO', '0')
                    cData += XML.montaTag('CODUSUARIO', 'p_heflo')
                    cData += XML.montaTag('CODFILIALDESTINO', CODFILIAL)
                    cData += XML.montaTag('GERADOPORLOTE', '0')
                    cData += XML.montaTag('STATUSEXPORTCONT', '0')
                    cData += XML.montaTag('GEROUCONTATRABALHO', '0')
                    cData += XML.montaTag('GERADOPORCONTATRABALHO', '0')
                    cData += XML.montaTag('HORULTIMAALTERACAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('INDUSOOBJ', '0.00')
                    cData += XML.montaTag('INTEGRADOBONUM', '0')
                    cData += XML.montaTag('FLAGPROCESSADO', '0')
                    cData += XML.montaTag('ABATIMENTOICMS', '0.0000')
                    cData += XML.montaTag('HORARIOEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('USUARIOCRIACAO', 'p_heflo')
                    cData += XML.montaTag('STSEMAIL', '0.0000')
                    cData += XML.montaTag('VALORBRUTOINTERNO', campos.valorTotal)
                    cData += XML.montaTag('VINCULADOESTOQUEFL', '0.0000')
                    cData += XML.montaTag('VRBASEINSSOUTRAEMPRESA', '0.0000')
                    cData += XML.montaTag('VALORDESCCONDICIONAL', '0.0000')
                    cData += XML.montaTag('VALORDESPCONDICIONAL', '0.0000')
                    cData += XML.montaTag('INTEGRADOAUTOMACAO', '0.0000')
                    cData += XML.montaTag('INTEGRAAPLICACAO', 'T')
                    cData += XML.montaTag('DATALANCAMENTO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('RECIBONFESTATUS', '0')
                    cData += XML.montaTag('VALORMERCADORIAS', '0.0000')
                    cData += XML.montaTag('USARATEIOVALORFIN', '1')
                    cData += XML.montaTag('CODCOLCFOAUX', '0')
                    cData += XML.montaTag('VALORRATEIOLAN', campos.valorTotal)
                    cData += XML.montaTag('RATEIOCCUSTODEPTO', campos.valorTotal)
                    cData += XML.montaTag('VALORBRUTOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROSORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORRATEIOLANORIG', campos.valorTotal)
                    cData += XML.montaTag('HISTORICOCURTO', HISTORICOCURTO)
                    cData += XML.montaTag('FLAGCONCLUSAO', '0')
                    cData += XML.montaTag('STATUSPARADIGMA', 'N')
                    cData += XML.montaTag('STATUSINTEGRACAO', 'N')
                    cData += XML.montaTag('PERCCOMISSAOVEN3', '0.0000')
                    cData += XML.montaTag('PERCCOMISSAOVEN4', '0.0000')
                    cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA)
                    cData += XML.montaTag('IDMOVHST', '-1')
                cData += '</TMOV>'
                cData += '<TNFE>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('VALORSERVICO', '0.0000')
                    cData += XML.montaTag('DEDUCAOSERVICO', '0.0000')
                    cData += XML.montaTag('ALIQUOTAISS', '0.0000')
                    cData += XML.montaTag('ISSRETIDO', '0')
                    cData += XML.montaTag('VALORISS', '0.0000')
                    cData += XML.montaTag('VALORCREDITOIPTU', '0.0000')
                    cData += XML.montaTag('BASEDECALCULO', '0.0000')
                    cData += XML.montaTag('EDITADO', '0')
                cData += '</TNFE>'
                cData += '<TMOVFISCAL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CONTRIBUINTECREDENCIADO', '0')
                    cData += XML.montaTag('OPERACAOCONSUMIDORFINAL', '0')
                    cData += XML.montaTag('OPERACAOPRESENCIAL', '0')
                cData += '</TMOVFISCAL>'
                cData += '<TMOVRATCCU>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('VALOR', campos.valorTotal)
                    cData += XML.montaTag('IDMOVRATCCU', '-1')
                cData += '</TMOVRATCCU>'
                // cData += '<TMOVPAGTO>'
                //     cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                //     cData += XML.montaTag('IDSEQPAGTO', '-1');
                //     cData += XML.montaTag('IDMOV', '-1');
                //     cData += XML.montaTag('TAXAADM', '0.0000');
                //     cData += XML.montaTag('IDLAN', '-1');
                //     cData += XML.montaTag('DATAVENCIMENTO', DATE.getDateTime());
                //     cData += XML.montaTag('TIPOPAGAMENTO', '1');
                //     cData += XML.montaTag('VALOR', campos.valorTotal);
                //     cData += XML.montaTag('DEBITOCREDITO', 'C');
                //     cData += XML.montaTag('IDSEQPAGTO1', '-1');
                // cData += '</TMOVPAGTO>'
                for (let i = 0; i < listaDeItens.length; i++) {
                    let codigoDaNatureza = (listaDeItens[i] as { codigoDaNatureza: string }).codigoDaNatureza;
                    let codigoDoItem = (listaDeItens[i] as { codigoDoItem: string }).codigoDoItem;
                    let qtdDoItem = (listaDeItens[i] as { qtdDoItem: string }).qtdDoItem;
                    let valorDoItem = (listaDeItens[i] as { valorDoItem: string }).valorDoItem;
                    let totalDoItem = (listaDeItens[i] as { totalDoItem: string }).totalDoItem;
            
                    cData += '<TITMMOV>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('CODFILIAL', CODFILIAL);
                        cData += XML.montaTag('NUMEROSEQUENCIAL', (i + 1).toString());
                        cData += XML.montaTag('IDPRD', codigoDoItem);
                        cData += XML.montaTag('QUANTIDADE', qtdDoItem);
                        cData += XML.montaTag('PRECOUNITARIO', valorDoItem); // PRECO UNITARIO
                        cData += XML.montaTag('PRECOTABELA', '0.0000');
                        cData += XML.montaTag('DATAEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao));
                        cData += XML.montaTag('CODUND', 'UN');
                        cData += XML.montaTag('QUANTIDADEARECEBER', qtdDoItem);
                        cData += XML.montaTag('VALORUNITARIO', '0.0000');
                        cData += XML.montaTag('VALORFINANCEIRO', '0.0000');
                        cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                        cData += XML.montaTag('ALIQORDENACAO', '0.0000');
                        cData += XML.montaTag('QUANTIDADEORIGINAL', qtdDoItem);
                        cData += XML.montaTag('FLAG', '0');
                        cData += XML.montaTag('FATORCONVUND', '0.0000');
                        cData += XML.montaTag('VALORBRUTOITEM', '0.0000'); 
                        cData += XML.montaTag('ITEM', totalDoItem);// PRECO UNITARIO X QTD
                        cData += XML.montaTag('QUANTIDADESEPARADA', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('COMISSAOREPRES', '0.0000');
                        cData += XML.montaTag('VALORESCRITURACAO', '0.0000');
                        cData += XML.montaTag('VALORFINPEDIDO', '0.0000');
                        cData += XML.montaTag('VALOROPFRM1', '0.0000');
                        cData += XML.montaTag('VALOROPFRM2', '0.0000');
                        cData += XML.montaTag('PRECOEDITADO', '0');
                        cData += XML.montaTag('QTDEVOLUMEUNITARIO', qtdDoItem);
                        cData += XML.montaTag('CODVEN1', campos.codigoDoComprador);
                        cData += XML.montaTag('PRECOTOTALEDITADO', '0');
                        cData += XML.montaTag('VALORDESCCONDICONALITM', '0.0000');
                        cData += XML.montaTag('VALORDESPCONDICIONALITM', '0.0000');
                        cData += XML.montaTag('CODTBORCAMENTO', codigoDaNatureza);
                        cData += XML.montaTag('CODCOLTBORCAMENTO', '0');
                        cData += XML.montaTag('VALORUNTORCAMENTO', '0.0000');
                        cData += XML.montaTag('VALSERVICONFE', '0.0000');
                        cData += XML.montaTag('CODLOC', ESTOQUE);
                        cData += XML.montaTag('VALORBEM', '0.0000');
                        cData += XML.montaTag('VALORLIQUIDO', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('RATEIOCCUSTODEPTO', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('VALORBRUTOITEMORIG', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('QUANTIDADETOTAL', '0.0000');
                        cData += XML.montaTag('PRODUTOSUBSTITUTO', '0');
                        cData += XML.montaTag('PRECOUNITARIOSELEC', '0');
                        cData += XML.montaTag('QUANTIDADECONCLUIDA', qtdDoItem);
                        cData += XML.montaTag('INTEGRAAPLICACAO', "T");
                        cData += XML.montaTag('VALORBASEDEPRECIACAOBEM', '0');
                        cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA);
                        cData += XML.montaTag('IDMOVHST', '-1');
                        cData += XML.montaTag('NSEQITMMOV1', (i + 1).toString());
                    cData += '</TITMMOV>'
                    cData += '<TITMMOVRATCCU>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                        cData += XML.montaTag('VALOR', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('IDMOVRATCCU', '-1');
                    cData += '</TITMMOVRATCCU>'
                    cData += '<TITMMOVCOMPL>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                    cData += '</TITMMOVCOMPL>'
                    // if(OC !== '' || AD !== ''){
                    //     cData += '<TITMMOVRELAC>'
                    //         cData += XML.montaTag('IDMOVORIGEM', OC);
                    //         cData += XML.montaTag('NSEQITMMOVORIGEM', (i + 1).toString());
                    //         cData += XML.montaTag('CODCOLORIGEM', CODCOLIGADA);
                    //         cData += XML.montaTag('IDMOVDESTINO', '-1');
                    //         cData += XML.montaTag('NSEQITMMOVDESTINO', (i + 1).toString());
                    //         cData += XML.montaTag('CODCOLDESTINO', CODCOLIGADA);
                    //         cData += XML.montaTag('QUANTIDADE', qtdDoItem);
                    //     cData += '</TITMMOVRELAC>'
                    // }
                    // for (let j = 0; j < tributos.length; j++) {
                    //     cData += '<TTRBITMMOV>';
                    //         cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA); 
                    //         cData += XML.montaTag('IDMOV', '-1');  
                    //         cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());   
                    //         cData += XML.montaTag('CODTRB', tributos[j]);
                    //         cData += XML.montaTag('BASEDECALCULO', totalDoItem);
                    //         cData += XML.montaTag('VALOR', '0.0000');    
                    //         cData += XML.montaTag('FATORREDUCAO', '0.0000');
                    //         cData += XML.montaTag('FATORSUBSTTRIB', '0.0000');
                    //         cData += XML.montaTag('BASEDECALCULOCALCULADA', totalDoItem);
                    //         cData += XML.montaTag('EDITADO', '0');
                    //         cData += XML.montaTag('PERCDIFERIMENTOPARCIALICMS', '0.0000');
                    //         cData += XML.montaTag('BASECHEIA', '0.0000');
                    //     cData += '</TTRBITMMOV>';
                    // }
                    cData += '<TITMMOVFISCAL>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('QTDECONTRATADA', '0.0000');
                        cData += XML.montaTag('VLRTOTTRIB', '0.0000');
                        cData += XML.montaTag('AQUISICAOPAA', '0');
                        cData += XML.montaTag('POEBTRIBUTAVEL', '1');
                    cData += '</TITMMOVFISCAL>';
                }
                cData += '<TMOVCOMPL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('MULTIPLO', 'N');
                    cData += XML.montaTag('TICKET', campos.ticketRaiz);
                    cData += XML.montaTag('LINKDOCUMENTO', (campos.anexarNotaFiscal).slice(0, 255));
                    cData += XML.montaTag('REMETENTE', campos.remetente);
                    cData += XML.montaTag('INICIOPRESTACAO', campos.inicioDaPrestacao);
                    cData += XML.montaTag('DESTINATARIO', campos.destinatario);
                    cData += XML.montaTag('TERMINOPRESTACAO', campos.terminoDaPrestacao);
                cData += '</TMOVCOMPL>'
                cData += '<TMOVTRANSP>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('RETIRAMERCADORIA', '0')
                    cData += XML.montaTag('TIPOCTE', '0')
                    cData += XML.montaTag('TOMADORTIPO', '0')
                    cData += XML.montaTag('TIPOEMITENTEMDFE', '0')
                    cData += XML.montaTag('LOTACAO', '1')
                    cData += XML.montaTag('TIPOTRANSPORTADORMDFE', '0')
                    cData += XML.montaTag('TIPOBPE', '0')
                cData += '</TMOVTRANSP>'
            cData += '</MovMovimento>'
        cData += ']]>';

        return cData;

    } catch (error) {
        console.log(error);
        throw error; 
    }

}

export function xmlMovRF(campos: any, CODCOLIGADA: string, CODFILIAL: string, SERIE: string, CODTMV: string, ESTOQUE: string, HISTORICOCURTO: string) {
    try {
        let listaDeItens = campos.itens as object[];
    
        var cData = '';
        cData += '<![CDATA['
            cData += '<MovMovimento>'
                cData += '<TMOV>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODFILIAL', CODFILIAL)
                    cData += XML.montaTag('CODLOC', ESTOQUE)
                    cData += XML.montaTag('CODLOCDESTINO', ESTOQUE)
                    cData += XML.montaTag('CODCFO', campos.codigoDoFornecedor)
                    cData += XML.montaTag('NUMEROMOV', (campos.numeroDaNF).slice(0, 9))
                    cData += XML.montaTag('SERIE', 'REC')
                    cData += XML.montaTag('CODTMV', CODTMV)
                    cData += XML.montaTag('TIPO', 'A')
                    cData += XML.montaTag('MOVIMPRESSO', '0')
                    cData += XML.montaTag('DOCIMPRESSO', '0')
                    cData += XML.montaTag('FATIMPRESSA', '0')
                    cData += XML.montaTag('DATAEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('COMISSAOREPRES', '0.0000')
                    cData += XML.montaTag('CODCPG', campos.codigoDaFormaPagamento)
                    cData += XML.montaTag('VALORBRUTO', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDO', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROS', campos.valorTotal)
                    cData += XML.montaTag('PERCENTUALFRETE', '0.0000')
                    cData += XML.montaTag('VALORFRETE', '0.0000')
                    cData += XML.montaTag('PERCENTUALDESC', '0.0000')
                    cData += XML.montaTag('VALORDESC', '0.0000')
                    cData += XML.montaTag('PERCENTUALDESP', '0.0000')
                    cData += XML.montaTag('VALORDESP', '0.0000')
                    cData += XML.montaTag('PERCCOMISSAO', '0.0000')
                    cData += XML.montaTag('CODMEN', '01')
                    cData += XML.montaTag('PESOLIQUIDO', '0.0000')
                    cData += XML.montaTag('PESOBRUTO', '0.0000')
                    cData += XML.montaTag('IDMOVLCTFLUXUS', '-1')
                    cData += XML.montaTag('CODMOEVALORLIQUIDO', 'R$')
                    cData += XML.montaTag('DATAMOVIMENTO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('GEROUFATURA', '0')
                    cData += XML.montaTag('NUMEROLCTABERTO', '1')
                    cData += XML.montaTag('CODCFOAUX', campos.codigoDoFornecedor)
                    cData += XML.montaTag('VALORRECEBIDO', campos.valorTotal)
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('CODVEN1', campos.codigoDoComprador)
                    cData += XML.montaTag('PERCCOMISSAOVEN2', '0.0000')
                    cData += XML.montaTag('CODCOLCFO', '0')
                    cData += XML.montaTag('CODUSUARIO', 'p_heflo')
                    cData += XML.montaTag('CODFILIALDESTINO', CODFILIAL)
                    cData += XML.montaTag('GERADOPORLOTE', '0')
                    cData += XML.montaTag('STATUSEXPORTCONT', '0')
                    cData += XML.montaTag('GEROUCONTATRABALHO', '0')
                    cData += XML.montaTag('GERADOPORCONTATRABALHO', '0')
                    cData += XML.montaTag('HORULTIMAALTERACAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('INDUSOOBJ', '0.00')
                    cData += XML.montaTag('INTEGRADOBONUM', '0')
                    cData += XML.montaTag('FLAGPROCESSADO', '0')
                    cData += XML.montaTag('ABATIMENTOICMS', '0.0000')
                    cData += XML.montaTag('HORARIOEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('USUARIOCRIACAO', 'p_heflo')
                    cData += XML.montaTag('STSEMAIL', '0.0000')
                    cData += XML.montaTag('VALORBRUTOINTERNO', campos.valorTotal)
                    cData += XML.montaTag('VINCULADOESTOQUEFL', '0.0000')
                    cData += XML.montaTag('VRBASEINSSOUTRAEMPRESA', '0.0000')
                    cData += XML.montaTag('VALORDESCCONDICIONAL', '0.0000')
                    cData += XML.montaTag('VALORDESPCONDICIONAL', '0.0000')
                    cData += XML.montaTag('INTEGRADOAUTOMACAO', '0.0000')
                    cData += XML.montaTag('INTEGRAAPLICACAO', 'T')
                    cData += XML.montaTag('DATALANCAMENTO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('RECIBONFESTATUS', '0')
                    cData += XML.montaTag('VALORMERCADORIAS', '0.0000')
                    cData += XML.montaTag('USARATEIOVALORFIN', '1')
                    cData += XML.montaTag('CODCOLCFOAUX', '0')
                    cData += XML.montaTag('VALORRATEIOLAN', campos.valorTotal)
                    cData += XML.montaTag('RATEIOCCUSTODEPTO', campos.valorTotal)
                    cData += XML.montaTag('VALORBRUTOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROSORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORRATEIOLANORIG', campos.valorTotal)
                    cData += XML.montaTag('HISTORICOCURTO', HISTORICOCURTO)
                    cData += XML.montaTag('FLAGCONCLUSAO', '0')
                    cData += XML.montaTag('STATUSPARADIGMA', 'N')
                    cData += XML.montaTag('STATUSINTEGRACAO', 'N')
                    cData += XML.montaTag('PERCCOMISSAOVEN3', '0.0000')
                    cData += XML.montaTag('PERCCOMISSAOVEN4', '0.0000')
                    cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA)
                    cData += XML.montaTag('IDMOVHST', '-1')
                cData += '</TMOV>'
                cData += '<TNFE>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('VALORSERVICO', '0.0000')
                    cData += XML.montaTag('DEDUCAOSERVICO', '0.0000')
                    cData += XML.montaTag('ALIQUOTAISS', '0.0000')
                    cData += XML.montaTag('ISSRETIDO', '0')
                    cData += XML.montaTag('VALORISS', '0.0000')
                    cData += XML.montaTag('VALORCREDITOIPTU', '0.0000')
                    cData += XML.montaTag('BASEDECALCULO', '0.0000')
                    cData += XML.montaTag('EDITADO', '0')
                cData += '</TNFE>'
                cData += '<TMOVFISCAL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CONTRIBUINTECREDENCIADO', '0')
                    cData += XML.montaTag('OPERACAOCONSUMIDORFINAL', '0')
                    cData += XML.montaTag('OPERACAOPRESENCIAL', '0')
                cData += '</TMOVFISCAL>'
                cData += '<TMOVRATCCU>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('VALOR', campos.valorTotal)
                    cData += XML.montaTag('IDMOVRATCCU', '-1')
                cData += '</TMOVRATCCU>'
                // cData += '<TMOVPAGTO>'
                //     cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                //     cData += XML.montaTag('IDSEQPAGTO', '-1');
                //     cData += XML.montaTag('IDMOV', '-1');
                //     cData += XML.montaTag('TAXAADM', '0.0000');
                //     cData += XML.montaTag('IDLAN', '-1');
                //     cData += XML.montaTag('DATAVENCIMENTO', DATE.getDateTime());
                //     cData += XML.montaTag('TIPOPAGAMENTO', '1');
                //     cData += XML.montaTag('VALOR', campos.valorTotal);
                //     cData += XML.montaTag('DEBITOCREDITO', 'C');
                //     cData += XML.montaTag('IDSEQPAGTO1', '-1');
                // cData += '</TMOVPAGTO>'
                for (let i = 0; i < listaDeItens.length; i++) {
                    let codigoDaNatureza = (listaDeItens[i] as { codigoDaNatureza: string }).codigoDaNatureza;
                    let codigoDoItem = (listaDeItens[i] as { codigoDoItem: string }).codigoDoItem;
                    let qtdDoItem = (listaDeItens[i] as { qtdDoItem: string }).qtdDoItem;
                    let valorDoItem = (listaDeItens[i] as { valorDoItem: string }).valorDoItem;
                    let totalDoItem = (listaDeItens[i] as { totalDoItem: string }).totalDoItem;
            
                    cData += '<TITMMOV>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('CODFILIAL', CODFILIAL);
                        cData += XML.montaTag('NUMEROSEQUENCIAL', (i + 1).toString());
                        cData += XML.montaTag('IDPRD', codigoDoItem);
                        cData += XML.montaTag('QUANTIDADE', qtdDoItem);
                        cData += XML.montaTag('PRECOUNITARIO', valorDoItem); // PRECO UNITARIO
                        cData += XML.montaTag('PRECOTABELA', '0.0000');
                        cData += XML.montaTag('DATAEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao));
                        cData += XML.montaTag('CODUND', 'UN');
                        cData += XML.montaTag('QUANTIDADEARECEBER', qtdDoItem);
                        cData += XML.montaTag('VALORUNITARIO', '0.0000');
                        cData += XML.montaTag('VALORFINANCEIRO', '0.0000');
                        cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                        cData += XML.montaTag('ALIQORDENACAO', '0.0000');
                        cData += XML.montaTag('QUANTIDADEORIGINAL', qtdDoItem);
                        cData += XML.montaTag('FLAG', '0');
                        cData += XML.montaTag('FATORCONVUND', '0.0000');
                        cData += XML.montaTag('VALORBRUTOITEM', '0.0000'); 
                        cData += XML.montaTag('ITEM', totalDoItem);// PRECO UNITARIO X QTD
                        cData += XML.montaTag('QUANTIDADESEPARADA', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('COMISSAOREPRES', '0.0000');
                        cData += XML.montaTag('VALORESCRITURACAO', '0.0000');
                        cData += XML.montaTag('VALORFINPEDIDO', '0.0000');
                        cData += XML.montaTag('VALOROPFRM1', '0.0000');
                        cData += XML.montaTag('VALOROPFRM2', '0.0000');
                        cData += XML.montaTag('PRECOEDITADO', '0');
                        cData += XML.montaTag('QTDEVOLUMEUNITARIO', qtdDoItem);
                        cData += XML.montaTag('CODVEN1', campos.codigoDoComprador);
                        cData += XML.montaTag('PRECOTOTALEDITADO', '0');
                        cData += XML.montaTag('VALORDESCCONDICONALITM', '0.0000');
                        cData += XML.montaTag('VALORDESPCONDICIONALITM', '0.0000');
                        cData += XML.montaTag('CODTBORCAMENTO', codigoDaNatureza);
                        cData += XML.montaTag('CODCOLTBORCAMENTO', '0');
                        cData += XML.montaTag('VALORUNTORCAMENTO', '0.0000');
                        cData += XML.montaTag('VALSERVICONFE', '0.0000');
                        cData += XML.montaTag('CODLOC', ESTOQUE);
                        cData += XML.montaTag('VALORBEM', '0.0000');
                        cData += XML.montaTag('VALORLIQUIDO', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('RATEIOCCUSTODEPTO', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('VALORBRUTOITEMORIG', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('QUANTIDADETOTAL', '0.0000');
                        cData += XML.montaTag('PRODUTOSUBSTITUTO', '0');
                        cData += XML.montaTag('PRECOUNITARIOSELEC', '0');
                        cData += XML.montaTag('QUANTIDADECONCLUIDA', qtdDoItem);
                        cData += XML.montaTag('INTEGRAAPLICACAO', "T");
                        cData += XML.montaTag('VALORBASEDEPRECIACAOBEM', '0');
                        cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA);
                        cData += XML.montaTag('IDMOVHST', '-1');
                        cData += XML.montaTag('NSEQITMMOV1', (i + 1).toString());
                    cData += '</TITMMOV>'
                    cData += '<TITMMOVRATCCU>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                        cData += XML.montaTag('VALOR', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('IDMOVRATCCU', '-1');
                    cData += '</TITMMOVRATCCU>'
                    cData += '<TITMMOVCOMPL>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                    cData += '</TITMMOVCOMPL>'
                    // if(OC !== '' || AD !== ''){
                    //     cData += '<TITMMOVRELAC>'
                    //         cData += XML.montaTag('IDMOVORIGEM', OC);
                    //         cData += XML.montaTag('NSEQITMMOVORIGEM', (i + 1).toString());
                    //         cData += XML.montaTag('CODCOLORIGEM', CODCOLIGADA);
                    //         cData += XML.montaTag('IDMOVDESTINO', '-1');
                    //         cData += XML.montaTag('NSEQITMMOVDESTINO', (i + 1).toString());
                    //         cData += XML.montaTag('CODCOLDESTINO', CODCOLIGADA);
                    //         cData += XML.montaTag('QUANTIDADE', qtdDoItem);
                    //     cData += '</TITMMOVRELAC>'
                    // }
                    // for (let j = 0; j < tributos.length; j++) {
                    //     cData += '<TTRBITMMOV>';
                    //         cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA); 
                    //         cData += XML.montaTag('IDMOV', '-1');  
                    //         cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());   
                    //         cData += XML.montaTag('CODTRB', tributos[j]);
                    //         cData += XML.montaTag('BASEDECALCULO', totalDoItem);
                    //         cData += XML.montaTag('VALOR', '0.0000');    
                    //         cData += XML.montaTag('FATORREDUCAO', '0.0000');
                    //         cData += XML.montaTag('FATORSUBSTTRIB', '0.0000');
                    //         cData += XML.montaTag('BASEDECALCULOCALCULADA', totalDoItem);
                    //         cData += XML.montaTag('EDITADO', '0');
                    //         cData += XML.montaTag('PERCDIFERIMENTOPARCIALICMS', '0.0000');
                    //         cData += XML.montaTag('BASECHEIA', '0.0000');
                    //     cData += '</TTRBITMMOV>';
                    // }
                    cData += '<TITMMOVFISCAL>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('QTDECONTRATADA', '0.0000');
                        cData += XML.montaTag('VLRTOTTRIB', '0.0000');
                        cData += XML.montaTag('AQUISICAOPAA', '0');
                        cData += XML.montaTag('POEBTRIBUTAVEL', '1');
                    cData += '</TITMMOVFISCAL>';
                }
                cData += '<TMOVCOMPL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('MULTIPLO', 'N');
                    cData += XML.montaTag('TICKET', campos.ticketRaiz);
                    cData += XML.montaTag('LINKDOCUMENTO', (campos.anexarNotaFiscal).slice(0, 255));
                    cData += XML.montaTag('REMETENTE', campos.remetente);
                    cData += XML.montaTag('INICIOPRESTACAO', campos.inicioDaPrestacao);
                    cData += XML.montaTag('DESTINATARIO', campos.destinatario);
                    cData += XML.montaTag('TERMINOPRESTACAO', campos.terminoDaPrestacao);
                cData += '</TMOVCOMPL>'
                cData += '<TMOVTRANSP>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('RETIRAMERCADORIA', '0')
                    cData += XML.montaTag('TIPOCTE', '0')
                    cData += XML.montaTag('TOMADORTIPO', '0')
                    cData += XML.montaTag('TIPOEMITENTEMDFE', '0')
                    cData += XML.montaTag('LOTACAO', '1')
                    cData += XML.montaTag('TIPOTRANSPORTADORMDFE', '0')
                    cData += XML.montaTag('TIPOBPE', '0')
                cData += '</TMOVTRANSP>'
            cData += '</MovMovimento>'
        cData += ']]>';

        return cData;

    } catch (error) {
        console.log(error);
        throw error; 
    }

}

export function xmlMovPAD(campos: any, CODCOLIGADA: string, CODFILIAL: string, SERIE: string, CODTMV: string, ESTOQUE: string, HISTORICOCURTO: string) {
    try {
        let listaDeItens = campos.itens as object[];
    
        var cData = '';
        cData += '<![CDATA['
            cData += '<MovMovimento>'
                cData += '<TMOV>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODFILIAL', CODFILIAL)
                    cData += XML.montaTag('CODLOC', ESTOQUE)
                    cData += XML.montaTag('CODLOCDESTINO', ESTOQUE)
                    cData += XML.montaTag('CODCFO', campos.codigoDoFornecedor)
                    cData += XML.montaTag('NUMEROMOV', '-1')
                    cData += XML.montaTag('SERIE', SERIE)
                    cData += XML.montaTag('CODTMV', CODTMV)
                    cData += XML.montaTag('TIPO', 'A')
                    cData += XML.montaTag('MOVIMPRESSO', '0')
                    cData += XML.montaTag('DOCIMPRESSO', '0')
                    cData += XML.montaTag('FATIMPRESSA', '0')
                    cData += XML.montaTag('DATAEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('COMISSAOREPRES', '0.0000')
                    cData += XML.montaTag('CODCPG', campos.codigoDaFormaPagamento)
                    cData += XML.montaTag('VALORBRUTO', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDO', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROS', campos.valorTotal)
                    cData += XML.montaTag('PERCENTUALFRETE', '0.0000')
                    cData += XML.montaTag('VALORFRETE', '0.0000')
                    cData += XML.montaTag('PERCENTUALDESC', '0.0000')
                    cData += XML.montaTag('VALORDESC', '0.0000')
                    cData += XML.montaTag('PERCENTUALDESP', '0.0000')
                    cData += XML.montaTag('VALORDESP', '0.0000')
                    cData += XML.montaTag('PERCCOMISSAO', '0.0000')
                    cData += XML.montaTag('CODMEN', '01')
                    cData += XML.montaTag('PESOLIQUIDO', '0.0000')
                    cData += XML.montaTag('PESOBRUTO', '0.0000')
                    cData += XML.montaTag('IDMOVLCTFLUXUS', '-1')
                    cData += XML.montaTag('CODMOEVALORLIQUIDO', 'R$')
                    cData += XML.montaTag('DATAMOVIMENTO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('GEROUFATURA', '0')
                    cData += XML.montaTag('NUMEROLCTABERTO', '1')
                    cData += XML.montaTag('CODCFOAUX', campos.codigoDoFornecedor)
                    cData += XML.montaTag('VALORRECEBIDO', campos.valorTotal)
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('CODVEN1', campos.codigoDoComprador)
                    cData += XML.montaTag('PERCCOMISSAOVEN2', '0.0000')
                    cData += XML.montaTag('CODCOLCFO', '0')
                    cData += XML.montaTag('CODUSUARIO', 'p_heflo')
                    cData += XML.montaTag('CODFILIALDESTINO', CODFILIAL)
                    cData += XML.montaTag('GERADOPORLOTE', '0')
                    cData += XML.montaTag('STATUSEXPORTCONT', '0')
                    cData += XML.montaTag('GEROUCONTATRABALHO', '0')
                    cData += XML.montaTag('GERADOPORCONTATRABALHO', '0')
                    cData += XML.montaTag('HORULTIMAALTERACAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('INDUSOOBJ', '0.00')
                    cData += XML.montaTag('INTEGRADOBONUM', '0')
                    cData += XML.montaTag('FLAGPROCESSADO', '0')
                    cData += XML.montaTag('ABATIMENTOICMS', '0.0000')
                    cData += XML.montaTag('HORARIOEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('USUARIOCRIACAO', 'p_heflo')
                    cData += XML.montaTag('STSEMAIL', '0.0000')
                    cData += XML.montaTag('VALORBRUTOINTERNO', campos.valorTotal)
                    cData += XML.montaTag('VINCULADOESTOQUEFL', '0.0000')
                    cData += XML.montaTag('VRBASEINSSOUTRAEMPRESA', '0.0000')
                    cData += XML.montaTag('VALORDESCCONDICIONAL', '0.0000')
                    cData += XML.montaTag('VALORDESPCONDICIONAL', '0.0000')
                    cData += XML.montaTag('INTEGRADOAUTOMACAO', '0.0000')
                    cData += XML.montaTag('INTEGRAAPLICACAO', 'T')
                    cData += XML.montaTag('DATALANCAMENTO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('RECIBONFESTATUS', '0')
                    cData += XML.montaTag('VALORMERCADORIAS', '0.0000')
                    cData += XML.montaTag('USARATEIOVALORFIN', '1')
                    cData += XML.montaTag('CODCOLCFOAUX', '0')
                    cData += XML.montaTag('VALORRATEIOLAN', campos.valorTotal)
                    cData += XML.montaTag('RATEIOCCUSTODEPTO', campos.valorTotal)
                    cData += XML.montaTag('VALORBRUTOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROSORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORRATEIOLANORIG', campos.valorTotal)
                    cData += XML.montaTag('HISTORICOCURTO', HISTORICOCURTO)
                    cData += XML.montaTag('FLAGCONCLUSAO', '0')
                    cData += XML.montaTag('STATUSPARADIGMA', 'N')
                    cData += XML.montaTag('STATUSINTEGRACAO', 'N')
                    cData += XML.montaTag('PERCCOMISSAOVEN3', '0.0000')
                    cData += XML.montaTag('PERCCOMISSAOVEN4', '0.0000')
                    cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA)
                    cData += XML.montaTag('IDMOVHST', '-1')
                cData += '</TMOV>'
                cData += '<TNFE>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('VALORSERVICO', '0.0000')
                    cData += XML.montaTag('DEDUCAOSERVICO', '0.0000')
                    cData += XML.montaTag('ALIQUOTAISS', '0.0000')
                    cData += XML.montaTag('ISSRETIDO', '0')
                    cData += XML.montaTag('VALORISS', '0.0000')
                    cData += XML.montaTag('VALORCREDITOIPTU', '0.0000')
                    cData += XML.montaTag('BASEDECALCULO', '0.0000')
                    cData += XML.montaTag('EDITADO', '0')
                cData += '</TNFE>'
                cData += '<TMOVFISCAL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CONTRIBUINTECREDENCIADO', '0')
                    cData += XML.montaTag('OPERACAOCONSUMIDORFINAL', '0')
                    cData += XML.montaTag('OPERACAOPRESENCIAL', '0')
                cData += '</TMOVFISCAL>'
                cData += '<TMOVRATCCU>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('VALOR', campos.valorTotal)
                    cData += XML.montaTag('IDMOVRATCCU', '-1')
                cData += '</TMOVRATCCU>'
                // cData += '<TMOVPAGTO>'
                //     cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                //     cData += XML.montaTag('IDSEQPAGTO', '-1');
                //     cData += XML.montaTag('IDMOV', '-1');
                //     cData += XML.montaTag('TAXAADM', '0.0000');
                //     cData += XML.montaTag('IDLAN', '-1');
                //     cData += XML.montaTag('DATAVENCIMENTO', DATE.getDateTime());
                //     cData += XML.montaTag('TIPOPAGAMENTO', '1');
                //     cData += XML.montaTag('VALOR', campos.valorTotal);
                //     cData += XML.montaTag('DEBITOCREDITO', 'C');
                //     cData += XML.montaTag('IDSEQPAGTO1', '-1');
                // cData += '</TMOVPAGTO>'
                for (let i = 0; i < listaDeItens.length; i++) {
                    let codigoDaNatureza = (listaDeItens[i] as { codigoDaNatureza: string }).codigoDaNatureza;
                    let codigoDoItem = (listaDeItens[i] as { codigoDoItem: string }).codigoDoItem;
                    let qtdDoItem = (listaDeItens[i] as { qtdDoItem: string }).qtdDoItem;
                    let valorDoItem = (listaDeItens[i] as { valorDoItem: string }).valorDoItem;
                    let totalDoItem = (listaDeItens[i] as { totalDoItem: string }).totalDoItem;
            
                    cData += '<TITMMOV>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('CODFILIAL', CODFILIAL);
                        cData += XML.montaTag('NUMEROSEQUENCIAL', (i + 1).toString());
                        cData += XML.montaTag('IDPRD', codigoDoItem);
                        cData += XML.montaTag('QUANTIDADE', qtdDoItem);
                        cData += XML.montaTag('PRECOUNITARIO', valorDoItem); // PRECO UNITARIO
                        cData += XML.montaTag('PRECOTABELA', '0.0000');
                        cData += XML.montaTag('DATAEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao));
                        cData += XML.montaTag('CODUND', 'UN');
                        cData += XML.montaTag('QUANTIDADEARECEBER', qtdDoItem);
                        cData += XML.montaTag('VALORUNITARIO', '0.0000');
                        cData += XML.montaTag('VALORFINANCEIRO', '0.0000');
                        cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                        cData += XML.montaTag('ALIQORDENACAO', '0.0000');
                        cData += XML.montaTag('QUANTIDADEORIGINAL', qtdDoItem);
                        cData += XML.montaTag('FLAG', '0');
                        cData += XML.montaTag('FATORCONVUND', '0.0000');
                        cData += XML.montaTag('VALORBRUTOITEM', '0.0000'); 
                        cData += XML.montaTag('ITEM', totalDoItem);// PRECO UNITARIO X QTD
                        cData += XML.montaTag('QUANTIDADESEPARADA', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('COMISSAOREPRES', '0.0000');
                        cData += XML.montaTag('VALORESCRITURACAO', '0.0000');
                        cData += XML.montaTag('VALORFINPEDIDO', '0.0000');
                        cData += XML.montaTag('VALOROPFRM1', '0.0000');
                        cData += XML.montaTag('VALOROPFRM2', '0.0000');
                        cData += XML.montaTag('PRECOEDITADO', '0');
                        cData += XML.montaTag('QTDEVOLUMEUNITARIO', qtdDoItem);
                        cData += XML.montaTag('CODVEN1', campos.codigoDoComprador);
                        cData += XML.montaTag('PRECOTOTALEDITADO', '0');
                        cData += XML.montaTag('VALORDESCCONDICONALITM', '0.0000');
                        cData += XML.montaTag('VALORDESPCONDICIONALITM', '0.0000');
                        cData += XML.montaTag('CODTBORCAMENTO', codigoDaNatureza);
                        cData += XML.montaTag('CODCOLTBORCAMENTO', '0');
                        cData += XML.montaTag('VALORUNTORCAMENTO', '0.0000');
                        cData += XML.montaTag('VALSERVICONFE', '0.0000');
                        cData += XML.montaTag('CODLOC', ESTOQUE);
                        cData += XML.montaTag('VALORBEM', '0.0000');
                        cData += XML.montaTag('VALORLIQUIDO', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('RATEIOCCUSTODEPTO', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('VALORBRUTOITEMORIG', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('QUANTIDADETOTAL', '0.0000');
                        cData += XML.montaTag('PRODUTOSUBSTITUTO', '0');
                        cData += XML.montaTag('PRECOUNITARIOSELEC', '0');
                        cData += XML.montaTag('QUANTIDADECONCLUIDA', qtdDoItem);
                        cData += XML.montaTag('INTEGRAAPLICACAO', "T");
                        cData += XML.montaTag('VALORBASEDEPRECIACAOBEM', '0');
                        cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA);
                        cData += XML.montaTag('IDMOVHST', '-1');
                        cData += XML.montaTag('NSEQITMMOV1', (i + 1).toString());
                    cData += '</TITMMOV>'
                    cData += '<TITMMOVRATCCU>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                        cData += XML.montaTag('VALOR', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('IDMOVRATCCU', '-1');
                    cData += '</TITMMOVRATCCU>'
                    cData += '<TITMMOVCOMPL>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                    cData += '</TITMMOVCOMPL>'
                    // if(OC !== '' || AD !== ''){
                    //     cData += '<TITMMOVRELAC>'
                    //         cData += XML.montaTag('IDMOVORIGEM', OC);
                    //         cData += XML.montaTag('NSEQITMMOVORIGEM', (i + 1).toString());
                    //         cData += XML.montaTag('CODCOLORIGEM', CODCOLIGADA);
                    //         cData += XML.montaTag('IDMOVDESTINO', '-1');
                    //         cData += XML.montaTag('NSEQITMMOVDESTINO', (i + 1).toString());
                    //         cData += XML.montaTag('CODCOLDESTINO', CODCOLIGADA);
                    //         cData += XML.montaTag('QUANTIDADE', qtdDoItem);
                    //     cData += '</TITMMOVRELAC>'
                    // }
                    // for (let j = 0; j < tributos.length; j++) {
                    //     cData += '<TTRBITMMOV>';
                    //         cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA); 
                    //         cData += XML.montaTag('IDMOV', '-1');  
                    //         cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());   
                    //         cData += XML.montaTag('CODTRB', tributos[j]);
                    //         cData += XML.montaTag('BASEDECALCULO', totalDoItem);
                    //         cData += XML.montaTag('VALOR', '0.0000');    
                    //         cData += XML.montaTag('FATORREDUCAO', '0.0000');
                    //         cData += XML.montaTag('FATORSUBSTTRIB', '0.0000');
                    //         cData += XML.montaTag('BASEDECALCULOCALCULADA', totalDoItem);
                    //         cData += XML.montaTag('EDITADO', '0');
                    //         cData += XML.montaTag('PERCDIFERIMENTOPARCIALICMS', '0.0000');
                    //         cData += XML.montaTag('BASECHEIA', '0.0000');
                    //     cData += '</TTRBITMMOV>';
                    // }
                    cData += '<TITMMOVFISCAL>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('QTDECONTRATADA', '0.0000');
                        cData += XML.montaTag('VLRTOTTRIB', '0.0000');
                        cData += XML.montaTag('AQUISICAOPAA', '0');
                        cData += XML.montaTag('POEBTRIBUTAVEL', '1');
                    cData += '</TITMMOVFISCAL>';
                }
                cData += '<TMOVCOMPL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('MULTIPLO', 'N');
                    cData += XML.montaTag('TICKET', campos.ticketRaiz);
                    cData += XML.montaTag('LINKDOCUMENTO', (campos.anexarNotaFiscal).slice(0, 255));
                    cData += XML.montaTag('REMETENTE', campos.remetente);
                    cData += XML.montaTag('INICIOPRESTACAO', campos.inicioDaPrestacao);
                    cData += XML.montaTag('DESTINATARIO', campos.destinatario);
                    cData += XML.montaTag('TERMINOPRESTACAO', campos.terminoDaPrestacao);
                cData += '</TMOVCOMPL>'
                cData += '<TMOVTRANSP>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('RETIRAMERCADORIA', '0')
                    cData += XML.montaTag('TIPOCTE', '0')
                    cData += XML.montaTag('TOMADORTIPO', '0')
                    cData += XML.montaTag('TIPOEMITENTEMDFE', '0')
                    cData += XML.montaTag('LOTACAO', '1')
                    cData += XML.montaTag('TIPOTRANSPORTADORMDFE', '0')
                    cData += XML.montaTag('TIPOBPE', '0')
                cData += '</TMOVTRANSP>'
            cData += '</MovMovimento>'
        cData += ']]>';

        return cData;

    } catch (error) {
        console.log(error);
        throw error; 
    }

}

export function xmlMovRFF(campos: any, CODCOLIGADA: string, CODFILIAL: string, SERIE: string, CODTMV: string, ESTOQUE: string, HISTORICOCURTO: string) {
    try {
        let listaDeItens = campos.itens as object[];
    
        var cData = '';
        cData += '<![CDATA['
            cData += '<MovMovimento>'
                cData += '<TMOV>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODFILIAL', CODFILIAL)
                    cData += XML.montaTag('CODLOC', ESTOQUE)
                    cData += XML.montaTag('CODLOCDESTINO', ESTOQUE)
                    cData += XML.montaTag('CODCFO', campos.codigoDoFornecedor)
                    cData += XML.montaTag('NUMEROMOV', '-1')
                    cData += XML.montaTag('SERIE', SERIE)
                    cData += XML.montaTag('CODTMV', CODTMV)
                    cData += XML.montaTag('TIPO', 'A')
                    cData += XML.montaTag('MOVIMPRESSO', '0')
                    cData += XML.montaTag('DOCIMPRESSO', '0')
                    cData += XML.montaTag('FATIMPRESSA', '0')
                    cData += XML.montaTag('DATAEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('COMISSAOREPRES', '0.0000')
                    cData += XML.montaTag('CODCPG', campos.codigoDaFormaPagamento)
                    cData += XML.montaTag('VALORBRUTO', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDO', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROS', campos.valorTotal)
                    cData += XML.montaTag('PERCENTUALFRETE', '0.0000')
                    cData += XML.montaTag('VALORFRETE', '0.0000')
                    cData += XML.montaTag('PERCENTUALDESC', '0.0000')
                    cData += XML.montaTag('VALORDESC', '0.0000')
                    cData += XML.montaTag('PERCENTUALDESP', '0.0000')
                    cData += XML.montaTag('VALORDESP', '0.0000')
                    cData += XML.montaTag('PERCCOMISSAO', '0.0000')
                    cData += XML.montaTag('CODMEN', '01')
                    cData += XML.montaTag('PESOLIQUIDO', '0.0000')
                    cData += XML.montaTag('PESOBRUTO', '0.0000')
                    cData += XML.montaTag('IDMOVLCTFLUXUS', '-1')
                    cData += XML.montaTag('CODMOEVALORLIQUIDO', 'R$')
                    cData += XML.montaTag('DATAMOVIMENTO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('GEROUFATURA', '0')
                    cData += XML.montaTag('NUMEROLCTABERTO', '1')
                    cData += XML.montaTag('CODCFOAUX', campos.codigoDoFornecedor)
                    cData += XML.montaTag('VALORRECEBIDO', campos.valorTotal)
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('CODVEN1', campos.codigoDoComprador)
                    cData += XML.montaTag('PERCCOMISSAOVEN2', '0.0000')
                    cData += XML.montaTag('CODCOLCFO', '0')
                    cData += XML.montaTag('CODUSUARIO', 'p_heflo')
                    cData += XML.montaTag('CODFILIALDESTINO', CODFILIAL)
                    cData += XML.montaTag('GERADOPORLOTE', '0')
                    cData += XML.montaTag('STATUSEXPORTCONT', '0')
                    cData += XML.montaTag('GEROUCONTATRABALHO', '0')
                    cData += XML.montaTag('GERADOPORCONTATRABALHO', '0')
                    cData += XML.montaTag('HORULTIMAALTERACAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('INDUSOOBJ', '0.00')
                    cData += XML.montaTag('INTEGRADOBONUM', '0')
                    cData += XML.montaTag('FLAGPROCESSADO', '0')
                    cData += XML.montaTag('ABATIMENTOICMS', '0.0000')
                    cData += XML.montaTag('HORARIOEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('USUARIOCRIACAO', 'p_heflo')
                    cData += XML.montaTag('STSEMAIL', '0.0000')
                    cData += XML.montaTag('VALORBRUTOINTERNO', campos.valorTotal)
                    cData += XML.montaTag('VINCULADOESTOQUEFL', '0.0000')
                    cData += XML.montaTag('VRBASEINSSOUTRAEMPRESA', '0.0000')
                    cData += XML.montaTag('VALORDESCCONDICIONAL', '0.0000')
                    cData += XML.montaTag('VALORDESPCONDICIONAL', '0.0000')
                    cData += XML.montaTag('INTEGRADOAUTOMACAO', '0.0000')
                    cData += XML.montaTag('INTEGRAAPLICACAO', 'T')
                    cData += XML.montaTag('DATALANCAMENTO', DATE.convertToISOFormat(campos.dataDeEmissao))
                    cData += XML.montaTag('RECIBONFESTATUS', '0')
                    cData += XML.montaTag('VALORMERCADORIAS', '0.0000')
                    cData += XML.montaTag('USARATEIOVALORFIN', '1')
                    cData += XML.montaTag('CODCOLCFOAUX', '0')
                    cData += XML.montaTag('VALORRATEIOLAN', campos.valorTotal)
                    cData += XML.montaTag('RATEIOCCUSTODEPTO', campos.valorTotal)
                    cData += XML.montaTag('VALORBRUTOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORLIQUIDOORIG', campos.valorTotal)
                    cData += XML.montaTag('VALOROUTROSORIG', campos.valorTotal)
                    cData += XML.montaTag('VALORRATEIOLANORIG', campos.valorTotal)
                    cData += XML.montaTag('HISTORICOCURTO', HISTORICOCURTO)
                    cData += XML.montaTag('FLAGCONCLUSAO', '0')
                    cData += XML.montaTag('STATUSPARADIGMA', 'N')
                    cData += XML.montaTag('STATUSINTEGRACAO', 'N')
                    cData += XML.montaTag('PERCCOMISSAOVEN3', '0.0000')
                    cData += XML.montaTag('PERCCOMISSAOVEN4', '0.0000')
                    cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA)
                    cData += XML.montaTag('IDMOVHST', '-1')
                cData += '</TMOV>'
                cData += '<TNFE>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('VALORSERVICO', '0.0000')
                    cData += XML.montaTag('DEDUCAOSERVICO', '0.0000')
                    cData += XML.montaTag('ALIQUOTAISS', '0.0000')
                    cData += XML.montaTag('ISSRETIDO', '0')
                    cData += XML.montaTag('VALORISS', '0.0000')
                    cData += XML.montaTag('VALORCREDITOIPTU', '0.0000')
                    cData += XML.montaTag('BASEDECALCULO', '0.0000')
                    cData += XML.montaTag('EDITADO', '0')
                cData += '</TNFE>'
                cData += '<TMOVFISCAL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CONTRIBUINTECREDENCIADO', '0')
                    cData += XML.montaTag('OPERACAOCONSUMIDORFINAL', '0')
                    cData += XML.montaTag('OPERACAOPRESENCIAL', '0')
                cData += '</TMOVFISCAL>'
                cData += '<TMOVRATCCU>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto)
                    cData += XML.montaTag('VALOR', campos.valorTotal)
                    cData += XML.montaTag('IDMOVRATCCU', '-1')
                cData += '</TMOVRATCCU>'
                // cData += '<TMOVPAGTO>'
                //     cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                //     cData += XML.montaTag('IDSEQPAGTO', '-1');
                //     cData += XML.montaTag('IDMOV', '-1');
                //     cData += XML.montaTag('TAXAADM', '0.0000');
                //     cData += XML.montaTag('IDLAN', '-1');
                //     cData += XML.montaTag('DATAVENCIMENTO', DATE.getDateTime());
                //     cData += XML.montaTag('TIPOPAGAMENTO', '1');
                //     cData += XML.montaTag('VALOR', campos.valorTotal);
                //     cData += XML.montaTag('DEBITOCREDITO', 'C');
                //     cData += XML.montaTag('IDSEQPAGTO1', '-1');
                // cData += '</TMOVPAGTO>'
                for (let i = 0; i < listaDeItens.length; i++) {
                    let codigoDaNatureza = (listaDeItens[i] as { codigoDaNatureza: string }).codigoDaNatureza;
                    let codigoDoItem = (listaDeItens[i] as { codigoDoItem: string }).codigoDoItem;
                    let qtdDoItem = (listaDeItens[i] as { qtdDoItem: string }).qtdDoItem;
                    let valorDoItem = (listaDeItens[i] as { valorDoItem: string }).valorDoItem;
                    let totalDoItem = (listaDeItens[i] as { totalDoItem: string }).totalDoItem;
            
                    cData += '<TITMMOV>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('CODFILIAL', CODFILIAL);
                        cData += XML.montaTag('NUMEROSEQUENCIAL', (i + 1).toString());
                        cData += XML.montaTag('IDPRD', codigoDoItem);
                        cData += XML.montaTag('QUANTIDADE', qtdDoItem);
                        cData += XML.montaTag('PRECOUNITARIO', valorDoItem); // PRECO UNITARIO
                        cData += XML.montaTag('PRECOTABELA', '0.0000');
                        cData += XML.montaTag('DATAEMISSAO', DATE.convertToISOFormat(campos.dataDeEmissao));
                        cData += XML.montaTag('CODUND', 'UN');
                        cData += XML.montaTag('QUANTIDADEARECEBER', qtdDoItem);
                        cData += XML.montaTag('VALORUNITARIO', '0.0000');
                        cData += XML.montaTag('VALORFINANCEIRO', '0.0000');
                        cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                        cData += XML.montaTag('ALIQORDENACAO', '0.0000');
                        cData += XML.montaTag('QUANTIDADEORIGINAL', qtdDoItem);
                        cData += XML.montaTag('FLAG', '0');
                        cData += XML.montaTag('FATORCONVUND', '0.0000');
                        cData += XML.montaTag('VALORBRUTOITEM', '0.0000'); 
                        cData += XML.montaTag('ITEM', totalDoItem);// PRECO UNITARIO X QTD
                        cData += XML.montaTag('QUANTIDADESEPARADA', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('COMISSAOREPRES', '0.0000');
                        cData += XML.montaTag('VALORESCRITURACAO', '0.0000');
                        cData += XML.montaTag('VALORFINPEDIDO', '0.0000');
                        cData += XML.montaTag('VALOROPFRM1', '0.0000');
                        cData += XML.montaTag('VALOROPFRM2', '0.0000');
                        cData += XML.montaTag('PRECOEDITADO', '0');
                        cData += XML.montaTag('QTDEVOLUMEUNITARIO', qtdDoItem);
                        cData += XML.montaTag('CODVEN1', campos.codigoDoComprador);
                        cData += XML.montaTag('PRECOTOTALEDITADO', '0');
                        cData += XML.montaTag('VALORDESCCONDICONALITM', '0.0000');
                        cData += XML.montaTag('VALORDESPCONDICIONALITM', '0.0000');
                        cData += XML.montaTag('CODTBORCAMENTO', codigoDaNatureza);
                        cData += XML.montaTag('CODCOLTBORCAMENTO', '0');
                        cData += XML.montaTag('VALORUNTORCAMENTO', '0.0000');
                        cData += XML.montaTag('VALSERVICONFE', '0.0000');
                        cData += XML.montaTag('CODLOC', ESTOQUE);
                        cData += XML.montaTag('VALORBEM', '0.0000');
                        cData += XML.montaTag('VALORLIQUIDO', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('RATEIOCCUSTODEPTO', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('VALORBRUTOITEMORIG', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('QUANTIDADETOTAL', '0.0000');
                        cData += XML.montaTag('PRODUTOSUBSTITUTO', '0');
                        cData += XML.montaTag('PRECOUNITARIOSELEC', '0');
                        cData += XML.montaTag('QUANTIDADECONCLUIDA', qtdDoItem);
                        cData += XML.montaTag('INTEGRAAPLICACAO', "T");
                        cData += XML.montaTag('VALORBASEDEPRECIACAOBEM', '0');
                        cData += XML.montaTag('CODCOLIGADA1', CODCOLIGADA);
                        cData += XML.montaTag('IDMOVHST', '-1');
                        cData += XML.montaTag('NSEQITMMOV1', (i + 1).toString());
                    cData += '</TITMMOV>'
                    cData += '<TITMMOVRATCCU>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('CODCCUSTO', campos.codigoDoCentroDeCusto);
                        cData += XML.montaTag('VALOR', totalDoItem); // PRECO UNITARIO X QTD
                        cData += XML.montaTag('IDMOVRATCCU', '-1');
                    cData += '</TITMMOVRATCCU>'
                    cData += '<TITMMOVCOMPL>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                    cData += '</TITMMOVCOMPL>'
                    // if(OC !== '' || AD !== ''){
                    //     cData += '<TITMMOVRELAC>'
                    //         cData += XML.montaTag('IDMOVORIGEM', OC);
                    //         cData += XML.montaTag('NSEQITMMOVORIGEM', (i + 1).toString());
                    //         cData += XML.montaTag('CODCOLORIGEM', CODCOLIGADA);
                    //         cData += XML.montaTag('IDMOVDESTINO', '-1');
                    //         cData += XML.montaTag('NSEQITMMOVDESTINO', (i + 1).toString());
                    //         cData += XML.montaTag('CODCOLDESTINO', CODCOLIGADA);
                    //         cData += XML.montaTag('QUANTIDADE', qtdDoItem);
                    //     cData += '</TITMMOVRELAC>'
                    // }
                    // for (let j = 0; j < tributos.length; j++) {
                    //     cData += '<TTRBITMMOV>';
                    //         cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA); 
                    //         cData += XML.montaTag('IDMOV', '-1');  
                    //         cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());   
                    //         cData += XML.montaTag('CODTRB', tributos[j]);
                    //         cData += XML.montaTag('BASEDECALCULO', totalDoItem);
                    //         cData += XML.montaTag('VALOR', '0.0000');    
                    //         cData += XML.montaTag('FATORREDUCAO', '0.0000');
                    //         cData += XML.montaTag('FATORSUBSTTRIB', '0.0000');
                    //         cData += XML.montaTag('BASEDECALCULOCALCULADA', totalDoItem);
                    //         cData += XML.montaTag('EDITADO', '0');
                    //         cData += XML.montaTag('PERCDIFERIMENTOPARCIALICMS', '0.0000');
                    //         cData += XML.montaTag('BASECHEIA', '0.0000');
                    //     cData += '</TTRBITMMOV>';
                    // }
                    cData += '<TITMMOVFISCAL>'
                        cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                        cData += XML.montaTag('IDMOV', '-1');
                        cData += XML.montaTag('NSEQITMMOV', (i + 1).toString());
                        cData += XML.montaTag('QTDECONTRATADA', '0.0000');
                        cData += XML.montaTag('VLRTOTTRIB', '0.0000');
                        cData += XML.montaTag('AQUISICAOPAA', '0');
                        cData += XML.montaTag('POEBTRIBUTAVEL', '1');
                    cData += '</TITMMOVFISCAL>';
                }
                cData += '<TMOVCOMPL>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA);
                    cData += XML.montaTag('IDMOV', '-1');
                    cData += XML.montaTag('MULTIPLO', 'N');
                    cData += XML.montaTag('TICKET', campos.ticketRaiz);
                    cData += XML.montaTag('LINKDOCUMENTO', (campos.anexarNotaFiscal).slice(0, 255));
                    cData += XML.montaTag('REMETENTE', campos.remetente);
                    cData += XML.montaTag('INICIOPRESTACAO', campos.inicioDaPrestacao);
                    cData += XML.montaTag('DESTINATARIO', campos.destinatario);
                    cData += XML.montaTag('TERMINOPRESTACAO', campos.terminoDaPrestacao);
                cData += '</TMOVCOMPL>'
                cData += '<TMOVTRANSP>'
                    cData += XML.montaTag('CODCOLIGADA', CODCOLIGADA)
                    cData += XML.montaTag('IDMOV', '-1')
                    cData += XML.montaTag('RETIRAMERCADORIA', '0')
                    cData += XML.montaTag('TIPOCTE', '0')
                    cData += XML.montaTag('TOMADORTIPO', '0')
                    cData += XML.montaTag('TIPOEMITENTEMDFE', '0')
                    cData += XML.montaTag('LOTACAO', '1')
                    cData += XML.montaTag('TIPOTRANSPORTADORMDFE', '0')
                    cData += XML.montaTag('TIPOBPE', '0')
                cData += '</TMOVTRANSP>'
            cData += '</MovMovimento>'
        cData += ']]>';

        return cData;

    } catch (error) {
        console.log(error);
        throw error; 
    }

}